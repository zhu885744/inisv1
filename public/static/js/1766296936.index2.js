import{a as e,t as a,u as t,v as s,w as i,x as l,y as o,A as n,p as r,d as c,B as d,C as m,D as p,h as u,m as g,j as f,F as v,G as x}from"./1766296936.element-plus.js";import{u as y,_ as h,p as b,a as w,b as k,e as _,n as j}from"./1766296936.index.js";import{R as V,y as C,o as z,c as I,G as L,f as D,$,s as U,F as M,g as T,a as A,Y as H,an as B,a0 as F,q as G,l as S,n as q,i as R,w as Y,T as E}from"./1766296936.@vue.js";import{u as J}from"./1766296936.vue-router.js";/* empty css                                                                  */import"./1766296936.lodash-es.js";import"./1766296936.@element-plus.js";import"./1766296936.@popperjs.js";import"./1766296936.@ctrl.js";import"./1766296936.dayjs.js";import"./1766296936.crypto-js.js";import"./1766296936.async-validator.js";import"./1766296936.memoize-one.js";import"./1766296936.normalize-wheel-es.js";import"./1766296936.@floating-ui.js";import"./1766296936.lscache.js";import"./1766296936.axios.js";import"./1766296936.notyf.js";import"./1766296936.pinia.js";import"./1766296936.vue-demi.js";import"./1766296936.lottie-web.js";import"./1766296936.bootstrap.js";import"./1766296936.plyr.js";import"./1766296936.rangetouch.js";import"./1766296936.loadjs.js";import"./1766296936.@fancyapps.js";import"./1766296936.highlight.js.js";import"./1766296936.@howdyjs.js";const K={class:"position-relative"},N={class:"position-absolute top-0 start-0 end-0 p-2"},O={class:"cover-shadow"},P={__name:"cover",props:{modelValue:{type:String,default:""}},setup(s){const i=s,l=V({type:"rand",imgs:[]}),o=()=>{let e=i.modelValue.split(",");l.imgs=e.filter(e=>!y.is.empty(e)),y.is.empty(l.imgs)?l.type="rand":1===l.imgs.length?l.type="image":l.type="carousel"},n=()=>"/api/file/rand?name=imgs.txt&id="+y.uuid();return C(()=>{o()}),(s,i)=>{const o=e,r=a,c=t;return z(),I("div",K,["rand"===L(l).type?(z(),D(o,{key:0,src:n(),style:{height:"200px"},class:"w-100 d-block pointer radius-4",fit:"cover"},{error:$(()=>[U(o,{src:n()},null,8,["src"])]),_:1},8,["src"])):"image"===L(l).type?(z(),D(o,{key:1,src:L(l).imgs[0],style:{height:"200px"},class:"w-100 d-block pointer radius-4",fit:"cover"},{error:$(()=>[U(o,{src:n()},null,8,["src"])]),_:1},8,["src"])):(z(),D(c,{key:2,height:"200px",direction:"vertical",interval:5e3},{default:$(()=>[(z(!0),I(M,null,T(L(l).imgs,(e,a)=>(z(),D(r,{key:a},{default:$(()=>[U(o,{src:e,fit:"cover",class:"w-100 pointer h-100 radius-4"},{error:$(()=>[U(o,{src:n()},null,8,["src"])]),_:1},8,["src"])]),_:2},1024))),128))]),_:1})),A("div",N,[H(s.$slots,"header")]),A("div",O,[H(s.$slots,"footer")])])}}},Q={__name:"image-text",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:a}){const t=e;return(e,a)=>{const o=s,n=i,r=l;return z(),D(r,{class:"w-100",direction:"vertical",alignment:"flex-start"},{default:$(()=>[U(n,{loading:t.modelValue,animated:""},{template:$(()=>[U(o,{variant:"image",style:{height:"200px"}}),U(o,{variant:"text",class:"w-50 mt-2 pb-0 h-18px d-block"})]),default:$(()=>[H(e.$slots,"default")]),_:3},8,["loading"])]),_:3})}}},W={class:"d-flex mb-lg-3 mb-2 position-relative"},X={class:"el-dropdown-link d-flex align-items-center"},Z={class:"d-flex"},ee=["onClick"],ae={class:"d-flex align-items-center"},te={class:"px-1"},se={class:"d-flex position-absolute end-0"},ie={class:"row"},le={class:"card mb-lg-3 mb-2 ribbon-box"},oe={class:"card-body p-2"},ne={key:0,class:"ribbon-two ribbon-two-danger"},re={class:"d-flex"},ce={class:"d-flex align-items-center"},de={class:"ms-1"},me={class:"d-flex align-items-center ms-2"},pe={class:"ms-1"},ue={class:"mb-0 mt-2 limit-1-line"},ge={key:1,class:"col-lg-12"},fe={class:"card card-body mb-0 d-flex align-items-center flex-column"},ve=h({__name:"post",setup(e){J();const a=V({article:{list:[],order:"top desc, views desc",like:[],load:!1},group:{action:null,list:[],load:!1},page:{show:!1,code:1,limit:6,total:1},item:{sort:"排序"}}),t={init:async(e=a.page.code)=>{a.article.load=!0;const t={page:e,limit:a.page.limit,order:a.article.order,like:a.article.like,where:"audit = 1"},{data:s}=await w.get("/api/article/all",t);a.article.load=!1,a.article.list=s.data,a.page.total=s.page,a.page.code=parseInt(e)},group:async()=>{a.group.load=!0;const{data:e}=await w.get("/api/article-group/column",{field:"id,name,avatar,description"});a.group.load=!1,a.group.list=e},order(e="create_time asc",s="排序"){a.item.sort=s,a.article.order=e,t.init(a.page.code)},refresh:()=>{a.article.like=[],a.group.action=null,t.init(a.page.code),t.group()},like:async(e=null)=>{y.is.empty(e)||(a.group.action=e,a.article.like=["group",`%|${e}|%`],await t.init())}};return C(()=>{t.init(a.page.code),t.group()}),(e,s)=>{const i=B("i-svg"),l=o,p=n,u=r,g=c,f=d,v=m;return z(),I(M,null,[A("div",W,[U(p,{class:"custom mimic me-1 text-ls-6px radius-5 scroll-item",trigger:"click"},{dropdown:$(()=>[U(l,{onClick:s[0]||(s[0]=e=>t.order("top desc, views desc","热门"))},{default:$(()=>[...s[5]||(s[5]=[F("热门",-1)])]),_:1}),U(l,{onClick:s[1]||(s[1]=e=>t.order("top desc, create_time desc","最新"))},{default:$(()=>[...s[6]||(s[6]=[F("最新",-1)])]),_:1}),U(l,{onClick:s[2]||(s[2]=e=>t.order("top desc, create_time asc","最早"))},{default:$(()=>[...s[7]||(s[7]=[F("最早",-1)])]),_:1})]),default:$(()=>[A("span",X,[F(G(L(a).item.sort)+" ",1),U(i,{name:"down"})])]),_:1}),S((z(),D(f,{style:{"max-width":"calc(100% - 130px)"}},{default:$(()=>[A("div",Z,[(z(!0),I(M,null,T(L(a).group.list,e=>(z(),I("button",{key:e.id,onClick:a=>t.like(e.id),type:"button",class:q("btn mx-1 btn-auto mimic radius-5 scroll-item"+(L(a).group.action===e.id?" action":""))},[U(g,{disabled:L(y).is.empty(e.description),content:e.description,placement:"top"},{default:$(()=>[A("div",ae,[L(y).is.empty(e.avatar)?R("",!0):(z(),D(u,{key:0,src:e.avatar,size:16},null,8,["src"])),A("span",te,G(e.name),1)])]),_:2},1032,["disabled","content"])],10,ee))),128))])]),_:1})),[[v,L(a).group.load]]),A("div",se,[U(g,{content:"刷新",placement:"top"},{default:$(()=>[A("button",{onClick:s[3]||(s[3]=(...e)=>t.refresh&&t.refresh(...e)),class:"btn btn-auto mimic radius-5 scrollbar-demo-item",type:"button"},[U(i,{name:"refresh"})])]),_:1})])]),A("div",ie,[L(y).is.empty(L(a).article.list)?S((z(),I("div",ge,[A("div",fe,[U(i,{name:"empty",size:"168px"}),s[9]||(s[9]=A("p",{class:"separator mb-0 text-muted"},"暂无内容",-1))])])),[[v,L(a).article.load]]):(z(!0),I(M,{key:0},T(L(a).article.list,e=>(z(),I("div",{key:e.id,class:"col-lg-6"},[A("div",le,[A("div",oe,[1!==e.top||L(a).article.load?R("",!0):(z(),I("div",ne,[...s[8]||(s[8]=[A("span",{class:"fw-medium"},"置顶",-1)])])),U(Q,{modelValue:L(a).article.load,"onUpdate:modelValue":s[4]||(s[4]=e=>L(a).article.load=e)},{default:$(()=>[U(P,{modelValue:e.covers,"onUpdate:modelValue":a=>e.covers=a,class:"mask pointer",onClick:a=>L(b)({name:"index-article-detail",params:{id:e.id}})},{footer:$(()=>{var a,t;return[A("span",re,[A("span",ce,[U(i,{name:"book",size:"14px",color:"rgb(var(--article-color))"}),A("span",de,G(e.views||0),1)]),A("span",me,[U(i,{name:"comment-outline",size:"18px",color:"rgb(var(--article-color))"}),A("span",pe,G((null==(t=null==(a=e.result)?void 0:a.comment)?void 0:t.count)||0),1)])]),A("span",null,G(L(y).natureTime(e.last_update||e.update_time)),1)]}),_:2},1032,["modelValue","onUpdate:modelValue","onClick"]),A("p",ue,G(e.title),1)]),_:2},1032,["modelValue"])])])]))),128))])],64)}}},[["__scopeId","data-v-7726169a"]]),xe={key:0,class:"flex-center"},ye={key:1,class:"flex-center"},he={class:"modal-footer d-flex justify-content-center"},be={__name:"sign-in",setup(e){const a={comm:k()},t=V({item:{wait:!1,finish:!0},date:new Date,days:[]}),s={init:async()=>{const e=s.range(),{code:i,data:l}=await w.get("/api/exp/column",{where:[["state","=",1],["type","=","check-in"],["uid","=",a.comm.login.user.id],["create_time",">=",e[0]],["create_time","<=",e[1]]],field:"id,value,create_time"});200===i&&(t.days=Array.from(new Set(l.map(e=>new Date(1e3*e.create_time).getDate()))))},day:e=>parseInt(e.day.split("-").slice(2).join("-")),signIn:async()=>{t.item.wait=!0;const{code:e,msg:a}=await w.post("/api/exp/check-in");if(t.item.wait=!1,200!==e)return j.error(a);j.info(a),await s.init()},range:()=>{const[e,a]=[new Date,new Date];return e.setDate(1),e.setHours(0,0,0,0),a.setMonth(a.getMonth()+1,1),a.setHours(0,0,0,0),[Math.floor(e.getTime()/1e3),Math.floor(a.getTime()/1e3)-1]},today:()=>(new Date).getDate()};return C(async()=>{await s.init()}),(e,a)=>{const i=B("i-svg"),l=p,o=u,n=g;return z(),D(n,{modelValue:L(t).item.dialog,"onUpdate:modelValue":a[3]||(a[3]=e=>L(t).item.dialog=e),"show-close":!1,class:"custom sm"},{header:$(()=>[L(y).in.array(s.today(),L(t).days)?(z(),I("div",xe,[U(_,{name:"finish",modelValue:L(t).item.finish,"onUpdate:modelValue":a[0]||(a[0]=e=>L(t).item.finish=e),width:"70px",height:"70px"},null,8,["modelValue"]),a[4]||(a[4]=A("span",{class:"fw-medium fs-3"},"已签到，经验值 +30",-1))])):(z(),I("div",ye,[U(i,{name:"check-in",size:"50px"}),a[5]||(a[5]=A("span",{class:"fw-medium fs-3 ms-2"},"签到领奖励！",-1))]))]),default:$(()=>[U(l,{modelValue:L(t).date,"onUpdate:modelValue":a[1]||(a[1]=e=>L(t).date=e),class:"sign-in mx-3 radius-10"},{header:$(({date:e})=>[a[6]||(a[6]=A("span",null,"本月签到",-1)),A("span",null,G(e),1)]),"date-cell":$(({data:e})=>[A("span",{class:q(L(y).in.array(s.day(e),L(t).days)?"check-in":"")},G(s.day(e)),3)]),_:1},8,["modelValue"])]),footer:$(()=>[A("div",he,[L(y).in.array(s.today(),L(t).days)?R("",!0):(z(),D(o,{key:0,onClick:a[2]||(a[2]=e=>s.signIn()),loading:L(t).item.wait},{default:$(()=>[F(G(L(t).item.wait?"签 到 中 ...":"立 即 签 到"),1)]),_:1},8,["loading"]))])]),_:1},8,["modelValue"])}}},we={class:"card mb-0"},ke={class:"card-body"},_e={key:0,class:"d-flex justify-content-between"},je={class:"d-flex align-items-center"},Ve={key:1,class:"d-flex justify-content-between"},Ce={class:"d-flex align-items-center"},ze={class:"d-flex flex-column ms-2"},Ie={class:"font-18 text-dark d-flex align-items-center"},Le={class:"badge-outline-info rounded-pill item right px-2 font-12 radius-10 d-flex align-items-center ms-2"},De={class:"fw-bold"},$e={class:"text-muted"},Ue={class:"d-flex justify-content-between mt-4 px-3"},Me=h({__name:"base-info",setup(e){J();const a={comm:k()},t=V({item:{signIn:!1}}),s={login:{show:()=>{a.comm.switchAuth("login",!0)}},signIn:()=>{if(!a.comm.getLogin.finish)return a.comm.switchAuth("login",!0);t.item.signIn=!0},compute:()=>{if(!a.comm.getLogin.finish)return a.comm.switchAuth("login",!0);b("/admin/account/home")}};return(e,i)=>{var l,o;const n=B("i-svg"),c=u,d=r;return z(),I(M,null,[A("div",we,[A("div",ke,[a.comm.getLogin.finish?(z(),I("div",Ve,[A("div",Ce,[A("div",null,[U(d,{src:a.comm.getLogin.user.avatar,fit:"cover",size:"large",class:"avatar-shadow mirror-scan"},null,8,["src"])]),A("div",ze,[A("span",Ie,[A("span",null,G(a.comm.getLogin.user.nickname),1),A("small",Le,[L(y).is.empty(null==(l=a.comm.getLogin.user)?void 0:l.gender)?R("",!0):(z(),D(n,{key:0,name:null==(o=a.comm.getLogin.user)?void 0:o.gender,size:"18px",class:"me-1"},null,8,["name"])),A("span",De,"Lv."+G(a.comm.getLogin.user.result.level.current.value),1)])]),A("small",$e,G(a.comm.getLogin.user.description||"这个人很懒，什么都没留下！"),1)])])])):(z(),I("div",_e,[A("div",je,[U(n,{name:"avatar",size:"40px"}),i[3]||(i[3]=A("div",{class:"d-flex flex-column ms-2"},[A("span",{class:"font-18 text-dark"},"您好！")],-1))]),U(c,{onClick:s.login.show,type:"primary",size:"small"},{default:$(()=>[...i[4]||(i[4]=[F("签到",-1)])]),_:1},8,["onClick"])])),A("div",Ue,[A("div",{onClick:i[0]||(i[0]=e=>s.compute()),class:"d-flex flex-column align-items-center pointer"},[U(n,{name:"integral",size:"30px",color:"rgb(var(--assist-color))"}),i[5]||(i[5]=A("span",{class:"mt-2"},"用户中心",-1))]),A("div",{onClick:i[1]||(i[1]=e=>s.signIn()),class:"d-flex flex-column align-items-center pointer"},[U(n,{name:"sign-in",size:"33px",color:"rgb(var(--assist-color))"}),i[6]||(i[6]=A("span",{style:{"margin-top":"0.46rem!important"}},"每日签到",-1))])])])]),U(be,{modelValue:L(t).item.signIn,"onUpdate:modelValue":i[2]||(i[2]=e=>L(t).item.signIn=e)},null,8,["modelValue"])],64)}}},[["__scopeId","data-v-98f1507a"]]),Te={key:0,class:"card mb-0 mt-2 mt-lg-3"},Ae={class:"card-header d-flex justify-content-between py-3 ps-3 bg-image"},He={class:"font-16 line-height-20 text-dark"},Be={class:"card-body p-2"},Fe=["innerHTML"],Ge={class:"d-flex flex-column ms-2"},Se={class:"d-flex align-items-center"},qe={class:"font-15 fw-medium text-dark me-1"},Re={class:"position-absolute end-0 fs-bolder"},Ye={class:"flex-center"},Ee={class:"bg-white p-3 radius-10"},Je={__name:"ranking",setup(a){const t=V({item:{dialog:!1},active:{load:!1,show:!1,list:[]},month:null,rules:[{name:"签到",exp:30,count:1},{name:"登录",exp:5,count:1},{name:"点赞",exp:1,count:10},{name:"收藏",exp:1,count:10},{name:"访问",exp:1,count:10},{name:"分享",exp:1,count:10},{name:"评论",exp:1,count:10}]}),s=async()=>{t.active.load=!0;const{code:e,data:a}=await w.get("/api/exp/active",{limit:8});t.active.load=!1,200===e&&(t.active.list=a)},i=(e=1)=>{let a={};switch(e){case 1:a={text:"1st",color:"var(--bs-pink)"};break;case 2:a={text:"2nd",color:"var(--bs-orange)"};break;case 3:a={text:"3rd",color:"var(--bs-green)"};break;default:a={text:e+"th",color:"var(--bs-gray)"}}return`<span style="color: ${a.color};"><span class="fw-bold">${a.text}</span></span>`},l=()=>{const e=new Date;t.month=e.getMonth()+1};return C(()=>{s(),l()}),Y(()=>t.active.list,e=>{t.active.show=!y.is.empty(e)}),(a,s)=>{const l=r,o=c,n=e,d=f,p=v,u=x,h=g,b=m;return z(),I(M,null,[L(t).active.show?S((z(),I("div",Te,[A("div",Ae,[A("span",He,G(L(t).month)+"月贡献榜",1),A("span",{onClick:s[0]||(s[0]=e=>L(t).item.dialog=!0),class:"font-13 text-info fw-medium pointer"},"如何上榜")]),A("div",Be,[(z(!0),I(M,null,T(L(t).active.list,(e,a)=>(z(),I("div",{key:e.id,class:"my-2 d-flex align-items-center position-relative"},[A("span",{innerHTML:i(a+1),style:{width:"30px"}},null,8,Fe),U(o,{content:`${e.nickname}：${e.description}`,disabled:!e.description,placement:"right"},{default:$(()=>[U(l,{src:e.avatar,size:40,class:q("avatar-shadow "+(e.description?"pointer":""))},null,8,["src","class"])]),_:2},1032,["content","disabled"]),A("span",Ge,[A("span",Se,[A("span",qe,G(e.nickname),1)]),A("small",null,"本月活跃 "+G(L(y).format.number(e.count))+" 次",1)]),A("span",Re,G(L(y).format.number(e.exp||0)),1)]))),128))])])),[[b,L(t).active.load]]):R("",!0),(z(),D(E,{to:"body"},[U(h,{modelValue:L(t).item.dialog,"onUpdate:modelValue":s[1]||(s[1]=e=>L(t).item.dialog=e),class:"custom"},{header:$(()=>[A("div",Ye,[U(n,{src:"/assets/imgs/logo-white.png",style:{height:"52px"},class:"my-1 py-1"})])]),default:$(()=>[A("div",Ee,[U(d,{type:"success",closable:!1,class:"mb-3"},{title:$(()=>[...s[2]||(s[2]=[A("p",{class:"mb-0"},"完成以下每日任务，可以获得对应的经验值",-1)])]),_:1}),U(u,{data:L(t).rules,stripe:"",style:{width:"100%"},class:"custom simple"},{default:$(()=>[U(p,{prop:"name",label:"名称"}),U(p,{prop:"exp",label:"经验值"},{default:$(e=>[F(" +"+G(e.row.exp),1)]),_:1}),U(p,{prop:"count",label:"次/日"})]),_:1},8,["data"])])]),_:1},8,["modelValue"])]))],64)}}},Ke={class:"container-fluid container-box px-2 px-lg-3"},Ne={class:"row"},Oe={class:"col-lg-9 px-2"},Pe={class:"col-lg-3 sticky"},Qe=h({__name:"index",setup:e=>(J(),V({}),(e,a)=>{const t=B("atom-banner-color-thief");return z(),I("div",Ke,[A("div",Ne,[A("div",Oe,[U(t,{class:"mb-3"}),U(ve)]),A("div",Pe,[U(Me),U(Je)])])])})},[["__scopeId","data-v-9390c5a6"]]);export{Qe as default};
