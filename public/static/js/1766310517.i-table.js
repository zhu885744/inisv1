import{x as e,B as a,C as t,D as o}from"./1766310517.element-plus.js";import{a as n,u as r,n as l}from"./1766310517.index.js";import{C as i}from"./1766310517.@howdyjs.js";import{R as s,o as c,c as p,l as g,G as d,f as m,$ as u,Y as y,F as h,g as b,a9 as f,q as C,i as k,h as w,a as v,s as S}from"./1766310517.@vue.js";const x={key:0},z={key:0},_={key:1},j={class:"mt-2"},R={key:0,class:"float-start"},$={class:"float-end custom"},A={__name:"i-table",props:{opts:{type:Object,default:{url:"",method:"get",params:{},headers:{},columns:[],menu:{}},required:!0},table:{type:Object,default:{defaultSort:{prop:"id",order:"descending"},rowStyle:{backgroundColor:"rgba(var(--theme-color), calc(var(--theme-opacity) * 0.8))"},cellStyle:{backgroundColor:"transparent",border:"unset",padding:"10px 0"},headerRowStyle:{backgroundColor:"transparent !important"},headerCellStyle:{backgroundColor:"rgba(var(--theme-color), var(--theme-opacity))",border:"unset"},style:{background:"rgba(var(--theme-color), calc(var(--theme-opacity) * 0.15))",backdropFilter:"blur(10px)",borderRadius:"8px"}}},pagination:{type:Object,default:{count:5,single:!0,class:"custom",background:!0,sizes:[10,50,100,500],layout:"sizes, prev, pager, next"}}},emits:["selection:change"],setup(A,{expose:F,emit:O}){const q=O,D=A,M=s({item:{data:[],count:0,page:{code:1,total:1},limit:D.pagination.sizes[0],order:"create_time asc",loading:{data:!1,page:!1},selection:[]},config:{table:{defaultSort:{prop:"id",order:"descending"},rowStyle:{backgroundColor:"rgba(var(--theme-color), calc(var(--theme-opacity) * 0.8))"},cellStyle:{backgroundColor:"transparent",border:"unset"},headerRowStyle:{backgroundColor:"transparent !important"},headerCellStyle:{backgroundColor:"rgba(var(--theme-color), var(--theme-opacity))",border:"unset"},style:{background:"rgba(var(--theme-color), calc(var(--theme-opacity) * 0.65))",backdropFilter:"var(--theme-blur)"},...D.table},pagination:{count:5,single:!0,class:"custom",background:!0,sizes:[10,50,100,500],layout:"sizes, prev, pager, next",...D.pagination},opts:{url:"",method:"get",params:{},headers:{},columns:[],menu:{},...D.opts}}}),B={init:async(e=M.item.page.code,a=M.item.limit)=>{M.item.loading.data=!0;const{data:t,code:o,msg:i}=await n[M.config.opts.method](M.config.opts.url,{page:e,limit:a,order:M.item.order,...M.config.opts.params});if(!r.in.array(o,[200,204]))return l.error(i);M.item.data=t.data,M.item.count=t.count,M.item.page.total=t.page,M.item.page.code=e,M.item.loading.data=!1,M.item.loading.page=!1},empty:e=>r.is.empty(e),inArray:(e,a)=>r.in.array(e,a),format:e=>r.format.number(e),nature:e=>r.time.nature(e)},G={sizeChange:e=>{M.item.limit=e,B.init()},currentChange:e=>B.init(e),mouseMenu(e,a,t){const{x:o,y:n}=t,r=i({el:t.currentTarget,params:{row:{...e},select:[...M.item.selection.map(e=>({...e}))]},...M.config.opts.menu});M.config.opts.menu.hidden||r.show(o,n),t.preventDefault()},selectionChange(e){M.item.selection=e,q("selection:change",e)}};return F({init:B.init}),(n,r)=>{const l=e,i=a,s=t,A=o;return c(),p(h,null,[g((c(),m(i,{ref:"selected","element-loading-text":"数据加载中 ...","element-loading-size":"20",onSelectionChange:G.selectionChange,onRowContextmenu:G.mouseMenu,data:d(M).item.data,"row-style":d(M).config.table.rowStyle,"cell-style":d(M).config.table.cellStyle,"header-row-style":d(M).config.table.headerRowStyle,"header-cell-style":d(M).config.table.headerCellStyle,"default-sort":d(M).config.table.defaultSort,style:w(d(M).config.table.style)},{default:u(()=>[y(n.$slots,"start"),y(n.$slots,"default"),(c(!0),p(h,null,b(d(M).config.opts.columns,(e,a)=>(c(),m(l,{key:a,prop:e.prop,label:e.label,width:e.width,"class-name":e.class,fixed:e.fixed,sortable:e.sortable,align:B.inArray(e.prop,["create_time","update_time"])?"center":e.align},f({_:2},[e.slot?{name:"default",fn:u(a=>[y(n.$slots,"i-"+e.prop,{scope:a.row})]),key:"0"}:{name:"default",fn:u(a=>[B.inArray(e.prop,["create_time","update_time"])?(c(),p("span",x,[B.empty(a.row[e.prop])?(c(),p("strong",_,"-")):(c(),p("span",z,C(B.nature(a.row[e.prop])),1))])):k("",!0)]),key:"1"}]),1032,["prop","label","width","class-name","fixed","sortable","align"]))),128)),y(n.$slots,"end")]),_:3},8,["onSelectionChange","onRowContextmenu","data","row-style","cell-style","header-row-style","header-cell-style","default-sort","style"])),[[A,d(M).item.loading.data]]),v("div",j,[d(M).item.count>0?(c(),p("div",R," 总计 "+C(d(M).item.count)+" 条数据 ",1)):k("",!0),v("div",$,[S(s,{background:d(M).config.pagination.background,onSizeChange:G.sizeChange,onCurrentChange:G.currentChange,"page-sizes":d(M).config.pagination.sizes,layout:d(M).config.pagination.layout,"popper-class":d(M).config.pagination.class,"pager-count":d(M).config.pagination.count,"hide-on-single-page":d(M).config.pagination.single,"page-size":d(M).item.limit,"page-count":d(M).item.page.total},null,8,["background","onSizeChange","onCurrentChange","page-sizes","layout","popper-class","pager-count","hide-on-single-page","page-size","page-count"])])])],64)}}};export{A as _};
