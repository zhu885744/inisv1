import{d as s,H as a,G as t,h as e,m as l,D as n}from"./1766310517.element-plus.js";import{a as o,n as i}from"./1766310517.index.js";import{R as c,y as u,w as r,an as d,o as m,c as p,l as g,G as f,a as v,s as b,$ as x,a0 as h,F as w}from"./1766310517.@vue.js";const _={class:"card mb-3"},y={class:"card-body"},S={class:"text-muted text-uppercase mt-0"},V={class:"d-inline-flex align-items-center"},k={class:"m-b-20"},j={class:"text-muted ms-1"},C={class:"row"},P={class:"col-md-6"},I={class:"form-group mb-3"},E={class:"form-label"},M={class:"col-md-6"},T={class:"form-group mb-3"},z={class:"form-label"},Q={__name:"qps",setup(Q,{expose:U}){const Y=c({struct:{value:0,json:{global:30,point:15}},status:{finish:!1,active:!1,dialog:!1,loading:!0,wait:!1}});u(async()=>{await D.init()});const D={init:async()=>{Y.status.finish=!1,Y.status.loading=!0;const{code:s,data:a}=await o.get("/api/config/one",{key:"SYSTEM_QPS"});Y.status.loading=!1,200===s&&(Y.struct=a,Y.status.finish=!0)},show(){if(!Y.status.finish)return i.warn("QPS配置获取失败，无法进行配置！");Y.status.dialog=!0},change:async s=>{const{code:a,msg:t}=await o.post("/api/config/save",{key:"SYSTEM_QPS",value:s?1:0});200!==a&&(Y.status.active=!s,i.error(t))},save:async()=>{Y.status.wait=!0;const{code:s,msg:a}=await o.post("/api/config/save",{key:"SYSTEM_QPS",json:JSON.stringify(Y.struct.json)});if(Y.status.wait=!1,200!==s)return i.error("保存失败："+a);Y.status.dialog=!1}};return r(()=>Y.struct,()=>{Y.status.active=1===parseInt(Y.struct.value),Y.struct.json.global<10&&(Y.struct.json.global=10),Y.struct.json.point<5&&(Y.struct.json.point=5)},{deep:!0}),U({init:D.init}),(o,i)=>{const c=d("i-svg"),u=s,r=a,Q=t,U=e,G=l,A=n;return m(),p(w,null,[g((m(),p("div",_,[v("div",y,[b(c,{name:"qps",size:"60px",color:"rgb(var(--assist-color))",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),v("h6",S,[b(u,{placement:"top"},{content:x(()=>[...i[7]||(i[7]=[v("strong",{class:"text-success"},"开启后让DDOS和CC等异常流量无懈可击！",-1),v("br",null,null,-1),h(" ● QPS俗称限流器，是一种作用于网络层的中间件，主要用于拦截异常流量，如DDOS和CC等",-1),v("br",null,null,-1),h(" ● QPS会将每个IP的请求次数限制在每秒的指定次数，超过则拒绝访问，从而保护服务器安全 ",-1)])]),default:x(()=>[v("span",V,[b(c,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),i[8]||(i[8]=v("span",{class:"ms-1"},"QPS",-1))])]),_:1})]),v("h2",k,[b(r,{modelValue:f(Y).status.active,"onUpdate:modelValue":i[0]||(i[0]=s=>f(Y).status.active=s),onChange:D.change,disabled:!f(Y).status.finish,"active-text":"我怂","inactive-text":"无所畏惧"},null,8,["modelValue","onChange","disabled"])]),i[10]||(i[10]=v("span",{class:"badge bg-primary font-white"}," +90% ",-1)),v("span",j,[i[9]||(i[9]=h(" 安全性提升，",-1)),v("span",{onClick:i[1]||(i[1]=s=>D.show()),class:"text-dark pointer"},"点我配置")])])])),[[A,f(Y).status.loading]]),b(G,{modelValue:f(Y).status.dialog,"onUpdate:modelValue":i[6]||(i[6]=s=>f(Y).status.dialog=s),class:"custom",draggable:"","close-on-click-modal":!1},{header:x(()=>[...i[11]||(i[11]=[v("strong",{class:"flex-center"},"配置",-1)])]),default:x(()=>[v("div",C,[v("div",P,[v("div",I,[v("label",E,[b(u,{content:"根据 IP 全局每秒限制的访问频率，推荐：50",placement:"top"},{default:x(()=>[v("span",null,[b(c,{name:"hint",size:"14px"}),i[12]||(i[12]=v("span",{class:"ms-1"},"全局限制：",-1))])]),_:1})]),b(Q,{modelValue:f(Y).struct.json.global,"onUpdate:modelValue":i[2]||(i[2]=s=>f(Y).struct.json.global=s),min:10,class:"w-100 d-flex"},null,8,["modelValue"])])]),v("div",M,[v("div",T,[v("label",z,[b(u,{content:"根据 IP + API 每秒限制的访问频率，推荐：15",placement:"top"},{default:x(()=>[v("span",null,[b(c,{name:"hint",size:"14px"}),i[13]||(i[13]=v("span",{class:"ms-1"},"单接口限制：",-1))])]),_:1})]),b(Q,{modelValue:f(Y).struct.json.point,"onUpdate:modelValue":i[3]||(i[3]=s=>f(Y).struct.json.point=s),min:5,class:"w-100 d-flex"},null,8,["modelValue"])])])])]),footer:x(()=>[b(U,{onClick:i[4]||(i[4]=s=>f(Y).status.dialog=!1)},{default:x(()=>[...i[14]||(i[14]=[h("取 消",-1)])]),_:1}),b(U,{onClick:i[5]||(i[5]=s=>D.save()),loading:f(Y).status.wait},{default:x(()=>[...i[15]||(i[15]=[h("保 存",-1)])]),_:1},8,["loading"])]),_:1},8,["modelValue"])],64)}}},U={class:"card mb-3"},Y={class:"card-body"},D={class:"text-muted text-uppercase mt-0"},G={class:"d-inline-flex align-items-center"},A={class:"m-b-20"},L={class:"text-muted ms-1"},O={class:"row"},q={class:"col-md-12"},F={class:"form-group mb-3"},H={class:"form-label"},J={__name:"page-limit",setup(_,{expose:y}){const S=c({struct:{text:10},status:{finish:!1,active:!1,dialog:!1,loading:!0,wait:!1}});u(async()=>{await V.init()});const V={init:async()=>{S.status.finish=!1,S.status.loading=!0;const{code:s,data:a}=await o.get("/api/config/one",{key:"SYSTEM_PAGE_LIMIT"});200===s&&(S.struct=a,S.status.finish=!0,S.status.loading=!1)},show(){if(!S.status.finish)return i.warn("分页限制配置获取失败，无法进行配置！");S.status.dialog=!0},change:async s=>{const{code:a,msg:t}=await o.post("/api/config/save",{key:"SYSTEM_PAGE_LIMIT",value:s?1:0});200!==a&&(S.status.active=!s,i.error(t))},save:async()=>{S.status.wait=!0;const{code:s,msg:a}=await o.post("/api/config/save",{key:"SYSTEM_PAGE_LIMIT",text:S.struct.text});if(S.status.wait=!1,200!==s)return i.error("保存失败："+a);S.status.dialog=!1}};return r(()=>S.struct,()=>{S.status.active=1===parseInt(S.struct.value),S.struct.text<5&&(S.struct.text=5)},{deep:!0}),y({init:V.init}),(o,i)=>{const c=d("i-svg"),u=s,r=a,_=t,y=e,k=l,j=n;return m(),p(w,null,[g((m(),p("div",U,[v("div",Y,[b(c,{name:"env",size:"50px",color:"rgb(var(--assist-color))",class:"position-absolute opacity-25",style:{right:"1.7rem"}}),v("h6",D,[b(u,{placement:"top"},{content:x(()=>[...i[6]||(i[6]=[v("strong",{class:"text-success"},"限制分页查询单次最大数据量，开启让系统毫无瑕疵！",-1),v("br",null,null,-1),h(" 分页限制可以限制坏人发起恶意请求，如恶意请求 999999 乃至无限大的数据，",-1),v("br",null,null,-1),h(" 导致服务器崩溃，分页限制可以限制每页最大请求数据量，超过则强制性=最大值",-1),v("br",null,null,-1),h(" 注意：如果开启了缓存，此项可不开，因为缓存数据不会导致重复查询 ",-1)])]),default:x(()=>[v("span",G,[b(c,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),i[7]||(i[7]=v("span",{class:"ms-1"},"分页限制",-1))])]),_:1})]),v("h2",A,[b(r,{modelValue:f(S).status.active,"onUpdate:modelValue":i[0]||(i[0]=s=>f(S).status.active=s),onChange:V.change,disabled:!f(S).status.finish,"active-text":"我怂","inactive-text":"无所畏惧"},null,8,["modelValue","onChange","disabled"])]),i[9]||(i[9]=v("span",{class:"badge bg-primary font-white"}," +5% ",-1)),v("span",L,[i[8]||(i[8]=h(" 安全性提升，",-1)),v("span",{onClick:i[1]||(i[1]=s=>V.show()),class:"text-dark pointer"},"点我配置")])])])),[[j,f(S).status.loading]]),b(k,{modelValue:f(S).status.dialog,"onUpdate:modelValue":i[5]||(i[5]=s=>f(S).status.dialog=s),class:"custom",draggable:"","close-on-click-modal":!1},{header:x(()=>[...i[10]||(i[10]=[v("strong",{class:"flex-center"},"配置",-1)])]),default:x(()=>[v("div",O,[v("div",q,[v("div",F,[v("label",H,[b(u,{content:"限制分页查询单次最大数据量，推荐：30",placement:"top"},{default:x(()=>[v("span",null,[b(c,{name:"hint",size:"14px"}),i[11]||(i[11]=v("span",{class:"ms-1"},"最大值：",-1))])]),_:1})]),b(_,{modelValue:f(S).struct.text,"onUpdate:modelValue":i[2]||(i[2]=s=>f(S).struct.text=s),min:5,class:"w-100 d-flex"},null,8,["modelValue"])])])])]),footer:x(()=>[b(y,{onClick:i[3]||(i[3]=s=>f(S).status.dialog=!1)},{default:x(()=>[...i[12]||(i[12]=[h("取 消",-1)])]),_:1}),b(y,{onClick:i[4]||(i[4]=s=>V.save()),loading:f(S).status.wait},{default:x(()=>[...i[13]||(i[13]=[h("保 存",-1)])]),_:1},8,["loading"])]),_:1},8,["modelValue"])],64)}}};export{Q as _,J as a};
