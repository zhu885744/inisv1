import{d as s,J as e,g as a,N as t,h as l,m as n,C as o,e as c,f as i,a as r,p as u,M as d,j as m,B as p,k as f,l as g}from"./1766296936.element-plus.js";import{s as b}from"./1766296936.@howdyjs.js";import{a as v,n as h,u as y,c as w,I as _,b as x,h as k,l as V}from"./1766296936.index.js";import{R as z,y as S,w as j,an as C,o as U,c as O,l as q,G as R,a as K,s as I,$ as J,a0 as A,aj as N,f as D,i as $,F as E,g as P,q as T,m as L,D as M}from"./1766296936.@vue.js";import{_ as B}from"./1766296936.api-key.js";import{_ as W,a as X}from"./1766296936.page-limit.js";import{_ as F}from"./1766296936.qps-black.js";import{_ as G}from"./1766296936.page2.js";import{_ as H}from"./1766296936.article2.js";import{M as Y}from"./1766296936.markdown-it.js";import"./1766296936.lodash-es.js";import"./1766296936.@element-plus.js";import"./1766296936.@popperjs.js";import"./1766296936.@ctrl.js";import"./1766296936.dayjs.js";import"./1766296936.crypto-js.js";import"./1766296936.async-validator.js";import"./1766296936.memoize-one.js";import"./1766296936.normalize-wheel-es.js";import"./1766296936.@floating-ui.js";import"./1766296936.lscache.js";import"./1766296936.axios.js";import"./1766296936.notyf.js";import"./1766296936.pinia.js";import"./1766296936.vue-demi.js";import"./1766296936.vue-router.js";import"./1766296936.lottie-web.js";import"./1766296936.bootstrap.js";import"./1766296936.plyr.js";import"./1766296936.rangetouch.js";import"./1766296936.loadjs.js";import"./1766296936.@fancyapps.js";import"./1766296936.highlight.js.js";import"./1766296936.entities.js";import"./1766296936.uc.micro.js";import"./1766296936.mdurl.js";import"./1766296936.linkify-it.js";const Q={class:"card mb-3"},Z={class:"card-body"},ss={class:"text-muted text-uppercase mt-0"},es={class:"d-inline-flex align-items-center"},as={class:"m-b-20"},ts={class:"text-muted"},ls={class:"row"},ns={class:"col-md-6"},os={class:"form-group mb-3"},cs={class:"form-label required"},is={class:"col-md-6"},rs={class:"form-group mb-3"},us={class:"form-label required"},ds={class:"row"},ms={class:"col-md-6"},ps={class:"form-group mb-3"},fs={class:"form-label required"},gs={class:"col-md-6"},bs={class:"form-group mb-3"},vs={class:"form-label required"},hs={class:"row"},ys={class:"col-md-6"},ws={class:"form-group mb-3"},_s={class:"form-label"},xs={class:"col-md-6"},ks={class:"form-group mb-3"},Vs={class:"form-label"},zs={class:"col-12"},Ss={class:"form-group mb-3"},js={class:"form-label"},Cs={__name:"sms-email",emits:["refresh"],setup(c,{expose:i,emit:r}){const u=z({struct:{email:null,host:null,port:null,account:null,password:null,nickname:null,sign_name:null,drive:{email:null,default:null}},status:{finish:!1,active:!1,dialog:!1,loading:!0,wait:!1,test:!1},backup:{}});S(async()=>{await d.init()});const d={init:async()=>{u.status.finish=!1,u.status.loading=!0;const{code:s,data:e}=await v.get("/api/toml/sms",{name:"email"});u.status.loading=!1,200===s&&(u.struct=e,u.backup=JSON.parse(JSON.stringify(e)),u.status.finish=!0)},show(){if(!u.status.finish)return h.warn("邮件服务配置获取失败，无法进行配置！");u.status.dialog=!0},change:async s=>{const{code:e,msg:a}=await v.put("/api/toml/sms-drive",{email:s?"email":""});200!==e&&(u.status.active=!s,h.error(a))},save:async()=>{if(!y.object.equal(u.struct,u.backup,["host","port","account","password"]))return h.warn("请先完成邮件服务测试");if(y.is.empty(u.struct.host))return h.warn("请填写邮件服务器地址！");if(y.is.empty(u.struct.port))return h.warn("请填写邮件服务器端口！");if(y.is.empty(u.struct.account))return h.warn("请填写邮件账号！");if(y.is.empty(u.struct.password))return h.warn("请填写服务密码！");if(y.is.empty(u.struct.sign_name))return h.warn("请填写邮件签名！");if(d.chinese(u.struct.nickname))return h.warn("邮件昵称不能包含中文！");u.status.wait=!0;const{code:s,msg:e}=await v.put("/api/toml/sms-email",u.struct);if(u.status.wait=!1,200!==s)return h.error("保存失败："+e);u.status.dialog=!1},test:async()=>{if(y.is.empty(u.struct.email))return h.warn("请填写接收者邮箱！");if(y.is.empty(u.struct.host))return h.warn("请填写邮件服务器地址！");if(y.is.empty(u.struct.port))return h.warn("请填写邮件服务器端口！");if(y.is.empty(u.struct.account))return h.warn("请填写邮件账号！");if(y.is.empty(u.struct.password))return h.warn("请填写服务密码！");if(y.is.empty(u.struct.sign_name))return h.warn("请填写邮件签名！");if(!y.is.email(u.struct.email))return h.warn("接收者邮箱格式不正确！");if(d.chinese(u.struct.nickname))return h.warn("邮件昵称不能包含中文！");u.status.test=!0;const{code:s,msg:e,data:a}=await v.post("/api/toml/test-sms-email",u.struct);if(u.status.test=!1,200===s)return u.backup=JSON.parse(JSON.stringify(u.struct)),h.success(e);h.error(`${e}<br>${a}`)},chinese:s=>/[\u4e00-\u9fa5]/.test(s)};return j(()=>u.struct,()=>{u.status.active="email"===u.struct.drive.email},{deep:!0}),i({init:d.init}),(c,i)=>{const r=C("i-svg"),m=s,p=e,f=a,g=t,b=l,v=n,h=o;return U(),O(E,null,[q((U(),O("div",Q,[K("div",Z,[I(r,{name:"email",color:"rgb(var(--assist-color))",size:"55px",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),K("h6",ss,[I(m,{placement:"top"},{content:J(()=>[...i[14]||(i[14]=[A(" ● 用于发送验证码、通知等邮件相关的服务",-1),K("br",null,null,-1),A(" ● 注册、找回密码、通知等功能都需要依赖此服务 ",-1)])]),default:J(()=>[K("span",es,[I(r,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),i[15]||(i[15]=K("span",{class:"ms-1"},"邮件服务",-1))])]),_:1})]),K("h2",as,[I(p,{modelValue:R(u).status.active,"onUpdate:modelValue":i[0]||(i[0]=s=>R(u).status.active=s),onChange:d.change,disabled:!R(u).status.finish,"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue","onChange","disabled"])]),i[17]||(i[17]=K("span",{class:"badge bg-danger font-white"}," 推荐 ",-1)),K("span",ts,[i[16]||(i[16]=A(" 因为不花钱，",-1)),K("span",{onClick:i[1]||(i[1]=s=>d.show()),class:"text-dark pointer"},"点我配置")])])])),[[h,R(u).status.loading]]),I(v,{modelValue:R(u).status.dialog,"onUpdate:modelValue":i[13]||(i[13]=s=>R(u).status.dialog=s),class:"custom",draggable:"","close-on-click-modal":!1},{header:J(()=>[...i[18]||(i[18]=[K("strong",{class:"flex-center"},"配置邮件服务",-1)])]),default:J(()=>[K("div",ls,[K("div",ns,[K("div",os,[K("label",cs,[I(m,{content:"邮件服务器地址，如：smtp.qq.com",placement:"top"},{default:J(()=>[K("span",null,[I(r,{name:"hint",size:"14px"}),i[19]||(i[19]=K("span",{class:"ms-1"},"邮件服务器地址：",-1))])]),_:1})]),I(f,{modelValue:R(u).struct.host,"onUpdate:modelValue":i[2]||(i[2]=s=>R(u).struct.host=s)},null,8,["modelValue"])])]),K("div",is,[K("div",rs,[K("label",us,[I(m,{content:"邮件服务端口，如：465",placement:"top"},{default:J(()=>[K("span",null,[I(r,{name:"hint",size:"14px"}),i[20]||(i[20]=K("span",{class:"ms-1"},"邮件服务端口：",-1))])]),_:1})]),I(g,{modelValue:R(u).struct.port,"onUpdate:modelValue":i[3]||(i[3]=s=>R(u).struct.port=s),class:"w-100 d-flex","controls-position":"right",min:1},null,8,["modelValue"])])])]),K("div",ds,[K("div",ms,[K("div",ps,[K("label",fs,[I(m,{content:"邮件账号，如：xxx@qq.com",placement:"top"},{default:J(()=>[K("span",null,[I(r,{name:"hint",size:"14px"}),i[21]||(i[21]=K("span",{class:"ms-1"},"邮件账号：",-1))])]),_:1})]),I(f,{modelValue:R(u).struct.account,"onUpdate:modelValue":i[4]||(i[4]=s=>R(u).struct.account=s)},null,8,["modelValue"])])]),K("div",gs,[K("div",bs,[K("label",vs,[I(m,{content:"服务密码，不是邮箱密码",placement:"top"},{default:J(()=>[K("span",null,[I(r,{name:"hint",size:"14px"}),i[22]||(i[22]=K("span",{class:"ms-1"},"服务密码：",-1))])]),_:1})]),I(f,{modelValue:R(u).struct.password,"onUpdate:modelValue":i[5]||(i[5]=s=>R(u).struct.password=s),"show-password":""},null,8,["modelValue"])])])]),K("div",hs,[K("div",ys,[K("div",ws,[K("label",_s,[I(m,{content:"邮件昵称，可以为空，但不能包含中文",placement:"top"},{default:J(()=>[K("span",null,[I(r,{name:"hint",size:"14px"}),i[23]||(i[23]=K("span",{class:"ms-1"},"邮件昵称：",-1))])]),_:1})]),I(f,{modelValue:R(u).struct.nickname,"onUpdate:modelValue":i[6]||(i[6]=s=>R(u).struct.nickname=s)},null,8,["modelValue"])])]),K("div",xs,[K("div",ks,[K("label",Vs,[I(m,{content:"邮件签名，也就是邮件的主题或标题，不推荐为空",placement:"top"},{default:J(()=>[K("span",null,[I(r,{name:"hint",size:"14px"}),i[24]||(i[24]=K("span",{class:"ms-1"},"邮件签名：",-1))])]),_:1})]),I(f,{modelValue:R(u).struct.sign_name,"onUpdate:modelValue":i[7]||(i[7]=s=>R(u).struct.sign_name=s)},null,8,["modelValue"])])]),K("div",zs,[K("div",Ss,[K("label",js,[I(m,{content:"用于邮件服务测试接收测试信息的邮箱",placement:"top"},{default:J(()=>[K("span",null,[I(r,{name:"hint",size:"14px"}),i[25]||(i[25]=K("span",{class:"ms-1"},"接收者邮箱：",-1))])]),_:1})]),I(f,{modelValue:R(u).struct.email,"onUpdate:modelValue":i[9]||(i[9]=s=>R(u).struct.email=s),onKeydown:i[10]||(i[10]=N(s=>d.test(),["enter"])),class:"custom",placeholder:"请输入邮箱"},{suffix:J(()=>[I(b,{onClick:i[8]||(i[8]=s=>d.test()),loading:R(u).status.test},{default:J(()=>[R(u).status.test?$("",!0):(U(),D(r,{key:0,name:"email",size:"14px"})),i[26]||(i[26]=K("span",{class:"ms-1"},"邮件服务测试",-1))]),_:1},8,["loading"])]),_:1},8,["modelValue"])])])])]),footer:J(()=>[I(b,{onClick:i[11]||(i[11]=s=>R(u).status.dialog=!1)},{default:J(()=>[...i[27]||(i[27]=[A("取 消",-1)])]),_:1}),I(b,{onClick:i[12]||(i[12]=s=>d.save()),loading:R(u).status.wait},{default:J(()=>[...i[28]||(i[28]=[A("保 存",-1)])]),_:1},8,["loading"])]),_:1},8,["modelValue"])],64)}}},Us={class:"card mb-3"},Os={class:"card-body"},qs={class:"text-muted text-uppercase mt-0"},Rs={class:"d-inline-flex align-items-center"},Ks={class:"m-b-20"},Is={class:"text-muted"},Js={class:"row"},As={class:"col-md-6"},Ns={class:"form-group mb-3"},Ds={class:"form-label required"},$s={class:"col-md-6"},Es={class:"form-group mb-3"},Ps={class:"form-label required"},Ts={class:"row"},Ls={class:"col-md-4"},Ms={class:"form-group mb-3"},Bs={class:"form-label required"},Ws={class:"col-md-4"},Xs={class:"form-group mb-3"},Fs={class:"form-label required"},Gs={class:"col-md-4"},Hs={class:"form-group mb-3"},Ys={class:"form-label required"},Qs={class:"row"},Zs={class:"col-12"},se={class:"form-group mb-3"},ee={class:"form-label"},ae={__name:"sms-aliyun",emits:["refresh"],setup(t,{expose:c,emit:i}){const r=i,u=z({struct:{access_key_id:null,access_key_secret:null,endpoint:null,sign_name:null,verify_code:null,phone:null,drive:{sms:null,default:null}},status:{finish:!1,active:!1,dialog:!1,loading:!0,test:!1,wait:!1},backup:{}});S(async()=>{await d.init()});const d={init:async()=>{u.status.finish=!1,u.status.loading=!0;const{code:s,data:e}=await v.get("/api/toml/sms",{name:"aliyun"});u.status.loading=!1,200===s&&(u.struct=e,u.backup=JSON.parse(JSON.stringify(e)),u.status.finish=!0)},show(){if(!u.status.finish)return h.warn("SMS服务配置获取失败，无法进行配置！");u.status.dialog=!0},change:async s=>{const{code:e,msg:a}=await v.put("/api/toml/sms-drive",{sms:s?"aliyun":""});if(200===e)return r("refresh","sms-tencent");u.status.active=!s,h.error(a)},save:async()=>{if(!y.object.equal(u.struct,u.backup,["access_key_id","access_key_secret","endpoint","sign_name","verify_code"]))return h.warn("请先完成阿里云短信测试");if(y.is.empty(u.struct.access_key_id))return h.warn("请填写阿里云AccessKey ID！");if(y.is.empty(u.struct.access_key_secret))return h.warn("请填写阿里云AccessKey Secret！");if(y.is.empty(u.struct.endpoint))return h.warn("请填写阿里云短信服务endpoint！");if(y.is.empty(u.struct.sign_name))return h.warn("请填写短信签名！");if(y.is.empty(u.struct.verify_code))return h.warn("请填写验证码模板！");u.status.wait=!0;const{code:s,msg:e}=await v.put("/api/toml/sms-aliyun",u.struct);if(u.status.wait=!1,200!==s)return h.error("保存失败："+e);u.status.dialog=!1},test:async()=>{if(y.is.empty(u.struct.phone))return h.warn("请填写接收者手机号！");if(y.is.empty(u.struct.access_key_id))return h.warn("请填写阿里云AccessKey ID！");if(y.is.empty(u.struct.access_key_secret))return h.warn("请填写阿里云AccessKey Secret！");if(y.is.empty(u.struct.endpoint))return h.warn("请填写阿里云短信服务endpoint！");if(y.is.empty(u.struct.sign_name))return h.warn("请填写短信签名！");if(y.is.empty(u.struct.verify_code))return h.warn("请填写验证码模板！");if(!y.is.phone(u.struct.phone))return h.warn("接收者手机号格式不正确！");u.status.test=!0;const{code:s,msg:e,data:a}=await v.post("/api/toml/test-sms-aliyun",u.struct);if(u.status.test=!1,200===s)return u.backup=JSON.parse(JSON.stringify(u.struct)),h.success(e);h.error(`${e}<br>${a}`)}};return j(()=>u.struct,()=>{u.status.active="aliyun"===u.struct.drive.sms},{deep:!0}),c({init:d.init}),(t,c)=>{const i=C("i-svg"),r=s,m=e,p=a,f=l,g=n,b=o;return U(),O(E,null,[q((U(),O("div",Us,[K("div",Os,[I(i,{name:"aliyun",color:"rgb(var(--assist-color))",size:"60px",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),K("h6",qs,[I(r,{placement:"top"},{content:J(()=>[...c[13]||(c[13]=[A(" ● 用于发送验证码相关的服务",-1),K("br",null,null,-1),A(" ● 注册、找回密码、通知等功能都需要依赖此服务 ",-1)])]),default:J(()=>[K("span",Rs,[I(i,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),c[14]||(c[14]=K("span",{class:"ms-1"},"阿里云短信",-1))])]),_:1})]),K("h2",Ks,[I(m,{modelValue:R(u).status.active,"onUpdate:modelValue":c[0]||(c[0]=s=>R(u).status.active=s),onChange:d.change,disabled:!R(u).status.finish,"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue","onChange","disabled"])]),c[16]||(c[16]=K("span",{class:"badge bg-warning font-white"}," 企业 ",-1)),K("span",Is,[c[15]||(c[15]=A(" 企业推荐这个，",-1)),K("span",{onClick:c[1]||(c[1]=s=>d.show()),class:"text-dark pointer"},"点我配置")])])])),[[b,R(u).status.loading]]),I(g,{modelValue:R(u).status.dialog,"onUpdate:modelValue":c[12]||(c[12]=s=>R(u).status.dialog=s),class:"custom",draggable:"","close-on-click-modal":!1},{header:J(()=>[...c[17]||(c[17]=[K("strong",{class:"flex-center"},"配置阿里云短信服务",-1)])]),default:J(()=>[K("div",Js,[K("div",As,[K("div",Ns,[K("label",Ds,[I(r,{content:"阿里云 AccessKey ID",placement:"top"},{default:J(()=>[K("span",null,[I(i,{name:"hint",size:"14px"}),c[18]||(c[18]=K("span",{class:"ms-1"},"AccessKey ID：",-1))])]),_:1})]),I(p,{modelValue:R(u).struct.access_key_id,"onUpdate:modelValue":c[2]||(c[2]=s=>R(u).struct.access_key_id=s),"show-password":""},null,8,["modelValue"])])]),K("div",$s,[K("div",Es,[K("label",Ps,[I(r,{content:"阿里云 AccessKey Secret",placement:"top"},{default:J(()=>[K("span",null,[I(i,{name:"hint",size:"14px"}),c[19]||(c[19]=K("span",{class:"ms-1"},"AccessKey Secret：",-1))])]),_:1})]),I(p,{modelValue:R(u).struct.access_key_secret,"onUpdate:modelValue":c[3]||(c[3]=s=>R(u).struct.access_key_secret=s),"show-password":""},null,8,["modelValue"])])])]),K("div",Ts,[K("div",Ls,[K("div",Ms,[K("label",Bs,[I(r,{content:"阿里云 短信服务 endpoint，如：dysmsapi.aliyuncs.com",placement:"top"},{default:J(()=>[K("span",null,[I(i,{name:"hint",size:"14px"}),c[20]||(c[20]=K("span",{class:"ms-1"},"endpoint：",-1))])]),_:1})]),I(p,{modelValue:R(u).struct.endpoint,"onUpdate:modelValue":c[4]||(c[4]=s=>R(u).struct.endpoint=s)},null,8,["modelValue"])])]),K("div",Ws,[K("div",Xs,[K("label",Fs,[I(r,{content:"短信签名，如：萌卜兔",placement:"top"},{default:J(()=>[K("span",null,[I(i,{name:"hint",size:"14px"}),c[21]||(c[21]=K("span",{class:"ms-1"},"短信签名：",-1))])]),_:1})]),I(p,{modelValue:R(u).struct.sign_name,"onUpdate:modelValue":c[5]||(c[5]=s=>R(u).struct.sign_name=s)},null,8,["modelValue"])])]),K("div",Gs,[K("div",Hs,[K("label",Ys,[I(r,{content:"验证码模板，如：SMS_XXX02",placement:"top"},{default:J(()=>[K("span",null,[I(i,{name:"hint",size:"14px"}),c[22]||(c[22]=K("span",{class:"ms-1"},"验证码模板：",-1))])]),_:1})]),I(p,{modelValue:R(u).struct.verify_code,"onUpdate:modelValue":c[6]||(c[6]=s=>R(u).struct.verify_code=s)},null,8,["modelValue"])])])]),K("div",Qs,[K("div",Zs,[K("div",se,[K("label",ee,[I(r,{content:"用于阿里云短信测试接收测试信息的手机号",placement:"top"},{default:J(()=>[K("span",null,[I(i,{name:"hint",size:"14px"}),c[23]||(c[23]=K("span",{class:"ms-1"},"接收者手机号：",-1))])]),_:1})]),I(p,{modelValue:R(u).struct.phone,"onUpdate:modelValue":c[8]||(c[8]=s=>R(u).struct.phone=s),onKeydown:c[9]||(c[9]=N(s=>d.test(),["enter"])),class:"custom",placeholder:"请输入手机号"},{suffix:J(()=>[I(f,{onClick:c[7]||(c[7]=s=>d.test()),loading:R(u).status.test},{default:J(()=>[R(u).status.test?$("",!0):(U(),D(i,{key:0,name:"phone",size:"14px"})),c[24]||(c[24]=K("span",{class:"ms-1"},"阿里云短信测试",-1))]),_:1},8,["loading"])]),_:1},8,["modelValue"])])])])]),footer:J(()=>[I(f,{onClick:c[10]||(c[10]=s=>R(u).status.dialog=!1)},{default:J(()=>[...c[25]||(c[25]=[A("取 消",-1)])]),_:1}),I(f,{onClick:c[11]||(c[11]=s=>d.save()),loading:R(u).status.wait},{default:J(()=>[...c[26]||(c[26]=[A("保 存",-1)])]),_:1},8,["loading"])]),_:1},8,["modelValue"])],64)}}},te={class:"card mb-3"},le={class:"card-body"},ne={class:"text-muted text-uppercase mt-0"},oe={class:"d-inline-flex align-items-center"},ce={class:"m-b-20"},ie={class:"text-muted"},re={class:"row"},ue={class:"col-md-6"},de={class:"form-group mb-3"},me={class:"form-label required"},pe={class:"col-md-6"},fe={class:"form-group mb-3"},ge={class:"form-label required"},be={class:"row"},ve={class:"col-md-6"},he={class:"form-group mb-3"},ye={class:"form-label required"},we={class:"col-md-6"},_e={class:"form-group mb-3"},xe={class:"form-label required"},ke={class:"row"},Ve={class:"col-md-4"},ze={class:"form-group mb-3"},Se={class:"form-labe requiredl"},je={class:"col-md-4"},Ce={class:"form-group mb-3"},Ue={class:"form-label required"},Oe={class:"col-md-4"},qe={class:"form-group mb-3"},Re={class:"form-label required"},Ke={class:"col-12"},Ie={class:"form-group mb-3"},Je={class:"form-label"},Ae={__name:"sms-tencent",emits:["refresh"],setup(t,{expose:c,emit:i}){const r=i,u=z({struct:{phone:null,secret_id:null,secret_key:null,endpoint:null,sms_sdk_app_id:null,sign_name:null,verify_code:null,region:null,drive:{sms:null,default:null}},status:{finish:!1,active:!1,dialog:!1,loading:!0,wait:!1,test:!1},backup:{}});S(async()=>{await d.init()});const d={init:async()=>{u.status.finish=!1,u.status.loading=!0;const{code:s,data:e}=await v.get("/api/toml/sms",{name:"tencent"});u.status.loading=!1,200===s&&(u.struct=e,u.backup=JSON.parse(JSON.stringify(e)),u.status.finish=!0)},show(){if(!u.status.finish)return h.warn("配置获取失败，无法进行配置！");u.status.dialog=!0},change:async s=>{const{code:e,msg:a}=await v.put("/api/toml/sms-drive",{sms:s?"tencent":""});if(200===e)return r("refresh","sms-aliyun");u.status.active=!s,h.error(a)},save:async()=>{if(!y.object.equal(u.struct,u.backup,["secret_id","secret_key","endpoint","sms_sdk_app_id","sign_name","verify_code","region"]))return h.warn("请先完成邮件服务测试");if(y.is.empty(u.struct.secret_id))return h.warn("请填写 SecretId！");if(y.is.empty(u.struct.secret_key))return h.warn("请填写 SecretKey！");if(y.is.empty(u.struct.endpoint))return h.warn("请填写 endpoint！");if(y.is.empty(u.struct.sms_sdk_app_id))return h.warn("请填写 appid！");if(y.is.empty(u.struct.sign_name))return h.warn("请填写 短信签名！");if(y.is.empty(u.struct.verify_code))return h.warn("请填写 验证码模板 id！");if(y.is.empty(u.struct.region))return h.warn("请填写 区域！");u.status.wait=!0;const{code:s,msg:e}=await v.put("/api/toml/sms-tencent",u.struct);if(u.status.wait=!1,200!==s)return h.error("保存失败："+e);u.status.dialog=!1},test:async()=>{if(y.is.empty(u.struct.phone))return h.warn("请填写接收者手机号！");if(y.is.empty(u.struct.secret_id))return h.warn("请填写 SecretId！");if(y.is.empty(u.struct.secret_key))return h.warn("请填写 SecretKey！");if(y.is.empty(u.struct.endpoint))return h.warn("请填写 endpoint！");if(y.is.empty(u.struct.sms_sdk_app_id))return h.warn("请填写 appid！");if(y.is.empty(u.struct.sign_name))return h.warn("请填写 短信签名！");if(y.is.empty(u.struct.verify_code))return h.warn("请填写 验证码模板 id！");if(y.is.empty(u.struct.region))return h.warn("请填写 区域！");if(!y.is.phone(u.struct.phone))return h.warn("接收者手机号格式不正确！");u.status.test=!0;const{code:s,msg:e,data:a}=await v.post("/api/toml/test-sms-tencent",u.struct);if(u.status.test=!1,200===s)return u.backup=JSON.parse(JSON.stringify(u.struct)),h.success(e);h.error(`${e}<br>${a}`)}};return j(()=>u.struct,()=>{u.status.active="tencent"===u.struct.drive.sms},{deep:!0}),c({init:d.init}),(t,c)=>{const i=C("i-svg"),r=s,m=e,p=a,f=l,g=n,b=o;return U(),O(E,null,[q((U(),O("div",te,[K("div",le,[I(i,{name:"tencent",color:"rgb(var(--assist-color))",size:"60px",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),K("h6",ne,[I(r,{placement:"top"},{content:J(()=>[...c[15]||(c[15]=[A(" ● 用于发送验证码相关的服务",-1),K("br",null,null,-1),A(" ● 注册、找回密码、通知等功能都需要依赖此服务 ",-1)])]),default:J(()=>[K("span",oe,[I(i,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),c[16]||(c[16]=K("span",{class:"ms-1"},"腾讯云短信",-1))])]),_:1})]),K("h2",ce,[I(m,{modelValue:R(u).status.active,"onUpdate:modelValue":c[0]||(c[0]=s=>R(u).status.active=s),onChange:d.change,disabled:!R(u).status.finish,"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue","onChange","disabled"])]),c[18]||(c[18]=K("span",{class:"badge bg-primary font-white"}," 企业 ",-1)),K("span",ie,[c[17]||(c[17]=A(" 也可以用这个，",-1)),K("span",{onClick:c[1]||(c[1]=s=>d.show()),class:"text-dark pointer"},"点我配置")])])])),[[b,R(u).status.loading]]),I(g,{modelValue:R(u).status.dialog,"onUpdate:modelValue":c[14]||(c[14]=s=>R(u).status.dialog=s),class:"custom",draggable:"","close-on-click-modal":!1},{header:J(()=>[...c[19]||(c[19]=[K("strong",{class:"flex-center"},"配置腾讯云短信服务",-1)])]),default:J(()=>[K("div",re,[K("div",ue,[K("div",de,[K("label",me,[I(r,{content:"腾讯云 SecretId",placement:"top"},{default:J(()=>[K("span",null,[I(i,{name:"hint",size:"14px"}),c[20]||(c[20]=K("span",{class:"ms-1"},"SecretId：",-1))])]),_:1})]),I(p,{modelValue:R(u).struct.secret_id,"onUpdate:modelValue":c[2]||(c[2]=s=>R(u).struct.secret_id=s),"show-password":""},null,8,["modelValue"])])]),K("div",pe,[K("div",fe,[K("label",ge,[I(r,{content:"腾讯云 SecretKey",placement:"top"},{default:J(()=>[K("span",null,[I(i,{name:"hint",size:"14px"}),c[21]||(c[21]=K("span",{class:"ms-1"},"SecretKey：",-1))])]),_:1})]),I(p,{modelValue:R(u).struct.secret_key,"onUpdate:modelValue":c[3]||(c[3]=s=>R(u).struct.secret_key=s),"show-password":""},null,8,["modelValue"])])])]),K("div",be,[K("div",ve,[K("div",he,[K("label",ye,[I(r,{content:"腾讯云短信服务 endpoint",placement:"top"},{default:J(()=>[K("span",null,[I(i,{name:"hint",size:"14px"}),c[22]||(c[22]=K("span",{class:"ms-1"},"endpoint：",-1))])]),_:1})]),I(p,{modelValue:R(u).struct.endpoint,"onUpdate:modelValue":c[4]||(c[4]=s=>R(u).struct.endpoint=s)},null,8,["modelValue"])])]),K("div",we,[K("div",_e,[K("label",xe,[I(r,{content:"腾讯云短信服务 appid",placement:"top"},{default:J(()=>[K("span",null,[I(i,{name:"hint",size:"14px"}),c[23]||(c[23]=K("span",{class:"ms-1"},"appid：",-1))])]),_:1})]),I(p,{modelValue:R(u).struct.sms_sdk_app_id,"onUpdate:modelValue":c[5]||(c[5]=s=>R(u).struct.sms_sdk_app_id=s)},null,8,["modelValue"])])])]),K("div",ke,[K("div",Ve,[K("div",ze,[K("label",Se,[I(r,{content:"短信签名，如：萌卜兔",placement:"top"},{default:J(()=>[K("span",null,[I(i,{name:"hint",size:"14px"}),c[24]||(c[24]=K("span",{class:"ms-1"},"短信签名：",-1))])]),_:1})]),I(p,{modelValue:R(u).struct.sign_name,"onUpdate:modelValue":c[6]||(c[6]=s=>R(u).struct.sign_name=s)},null,8,["modelValue"])])]),K("div",je,[K("div",Ce,[K("label",Ue,[I(r,{content:"验证码模板 id，如：146XXX",placement:"top"},{default:J(()=>[K("span",null,[I(i,{name:"hint",size:"14px"}),c[25]||(c[25]=K("span",{class:"ms-1"},"验证码模板 id：",-1))])]),_:1})]),I(p,{modelValue:R(u).struct.verify_code,"onUpdate:modelValue":c[7]||(c[7]=s=>R(u).struct.verify_code=s)},null,8,["modelValue"])])]),K("div",Oe,[K("div",qe,[K("label",Re,[I(r,{content:"短信服务所属区域，如：ap-guangzhou",placement:"top"},{default:J(()=>[K("span",null,[I(i,{name:"hint",size:"14px"}),c[26]||(c[26]=K("span",{class:"ms-1"},"区域：",-1))])]),_:1})]),I(p,{modelValue:R(u).struct.region,"onUpdate:modelValue":c[8]||(c[8]=s=>R(u).struct.region=s)},null,8,["modelValue"])])]),K("div",Ke,[K("div",Ie,[K("label",Je,[I(r,{content:"用于腾讯云短信测试接收测试信息的手机号",placement:"top"},{default:J(()=>[K("span",null,[I(i,{name:"hint",size:"14px"}),c[27]||(c[27]=K("span",{class:"ms-1"},"接收者手机号：",-1))])]),_:1})]),I(p,{modelValue:R(u).struct.phone,"onUpdate:modelValue":c[10]||(c[10]=s=>R(u).struct.phone=s),onKeydown:c[11]||(c[11]=N(s=>d.test(),["enter"])),class:"custom",placeholder:"请输入手机号"},{suffix:J(()=>[I(f,{onClick:c[9]||(c[9]=s=>d.test()),loading:R(u).status.test},{default:J(()=>[R(u).status.test?$("",!0):(U(),D(i,{key:0,name:"phone",size:"14px"})),c[28]||(c[28]=K("span",{class:"ms-1"},"腾讯云短信测试",-1))]),_:1},8,["loading"])]),_:1},8,["modelValue"])])])])]),footer:J(()=>[I(f,{onClick:c[12]||(c[12]=s=>R(u).status.dialog=!1)},{default:J(()=>[...c[29]||(c[29]=[A("取 消",-1)])]),_:1}),I(f,{onClick:c[13]||(c[13]=s=>d.save()),loading:R(u).status.wait},{default:J(()=>[...c[30]||(c[30]=[A("保 存",-1)])]),_:1},8,["loading"])]),_:1},8,["modelValue"])],64)}}},Ne={class:"card mb-3"},De={class:"card-body"},$e={class:"text-muted text-uppercase mt-0"},Ee={class:"d-inline-flex align-items-center"},Pe={class:"m-b-20"},Te={class:"text-muted ms-1"},Le={class:"row"},Me={class:"col-lg-6"},Be={class:"form-group mb-3"},We={class:"form-label"},Xe={class:"font-13"},Fe={class:"col-lg-6"},Ge={class:"form-group mb-3"},He={class:"form-label"},Ye={class:"font-13 d-flex align-items-center"},Qe={class:"text-muted"},Ze={__name:"allow-register",setup(a,{expose:t}){const r=z({item:{auth:[]},struct:{key:"ALLOW_REGISTER"},status:{finish:!1,active:!1,dialog:!1,loading:!0,wait:!1},select:{auth:[],value:[{value:"0",label:"禁止注册",color:"var(--bs-danger)"},{value:"1",label:"允许注册",color:"var(--bs-success)"}]}}),u={init:async()=>{r.status.finish=!1,r.status.loading=!0;const{code:s,data:e}=await v.get("/api/config/one",{key:"ALLOW_REGISTER"});r.status.loading=!1,200===s&&(r.struct=e,r.status.finish=!0)},change:async s=>{const{code:e,msg:a}=await v.post("/api/config/save",{key:"ALLOW_REGISTER",value:s?1:0});200!==e&&(r.status.active=!s,h.error(a))},show(){if(!r.status.finish)return h.warn("配置获取失败，无法进行配置！");r.status.dialog=!0},save:async()=>{r.status.wait=!0;const{code:s,msg:e}=await v.post("/api/config/save",{...r.struct,text:r.item.auth});if(r.status.wait=!1,200!==s)return h.error("保存失败："+e);r.status.dialog=!1},auth:async()=>{const{code:s,data:e}=await v.get("/api/auth-group/column",{field:"id,key,name,root"});200===s&&(r.select.auth=e.map(s=>(s.color=1===s.root?"var(--bs-success)":"var(--bs-secondary)",s)))}};return S(()=>{u.init(),u.auth()}),j(()=>r.struct,s=>{var e,a;r.item.auth=((null==(e=null==s?void 0:s.text)?void 0:e.split(","))||[]).filter(s=>!y.is.empty(s)).map(s=>parseInt(s)),r.status.active=1===parseInt(null==(a=r.struct)?void 0:a.value)},{deep:!0}),j(()=>r.status.active,s=>{r.struct.value=s?"1":"0"}),t({init:u.init}),(a,t)=>{const d=C("i-svg"),m=s,p=e,f=c,g=i,b=l,v=n,h=o;return U(),O(E,null,[q((U(),O("div",Ne,[K("div",De,[I(d,{name:"register",color:"rgb(var(--assist-color))",size:"50px",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),K("h6",$e,[I(m,{placement:"top"},{content:J(()=>[...t[7]||(t[7]=[A(" ● 是否允许用户自行注册账号（开放注册功能？）",-1),K("br",null,null,-1),A(" ● 如果不允许，那么只能通过管理员手动创建账号 ",-1)])]),default:J(()=>[K("span",Ee,[I(d,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),t[8]||(t[8]=K("span",{class:"ms-1"},"注 册",-1))])]),_:1})]),K("h2",Pe,[I(p,{modelValue:R(r).status.active,"onUpdate:modelValue":t[0]||(t[0]=s=>R(r).status.active=s),onChange:u.change,disabled:!R(r).status.finish,"active-text":"允许","inactive-text":"不允许"},null,8,["modelValue","onChange","disabled"])]),t[10]||(t[10]=K("span",{class:"badge bg-primary font-white"}," +0.1% ",-1)),K("span",Te,[t[9]||(t[9]=A(" 安全性提升，",-1)),K("span",{onClick:t[1]||(t[1]=s=>u.show()),class:"text-dark pointer"},"点我配置")])])])),[[h,R(r).status.loading]]),I(v,{modelValue:R(r).status.dialog,"onUpdate:modelValue":t[6]||(t[6]=s=>R(r).status.dialog=s),class:"custom",draggable:"","close-on-click-modal":!1},{header:J(()=>[...t[11]||(t[11]=[K("strong",{class:"flex-center"},"配置",-1)])]),default:J(()=>[K("div",Le,[K("div",Me,[K("div",Be,[K("label",We,[I(m,{placement:"top"},{content:J(()=>[...t[12]||(t[12]=[K("span",null,"（可选）为该分组的用户分配更高级的权限",-1),K("br",null,null,-1),K("span",null,"● 默认：即便用户拥有了对应的权限，也只能操作自己的数据，适用于普通用户或会员",-1),K("br",null,null,-1),K("span",null,"● 管理权限：该权限适用于有管理权限的用户，比如管理员和编辑员等，对别人的数据有操作权限",-1),K("br",null,null,-1)])]),default:J(()=>[K("span",null,[I(d,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),t[13]||(t[13]=K("span",{class:"ms-1"},"注册：",-1))])]),_:1})]),I(g,{modelValue:R(r).struct.value,"onUpdate:modelValue":t[2]||(t[2]=s=>R(r).struct.value=s),placeholder:"请选择权限",class:"d-block custom font-13"},{default:J(()=>[(U(!0),O(E,null,P(R(r).select.value,s=>(U(),D(f,{key:s.value,label:s.label,value:s.value,class:"d-flex align-items-center"},{default:J(()=>[I(d,{name:"dot",color:s.color,size:"20px"},null,8,["color"]),K("span",Xe,T(s.label),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])])]),K("div",Fe,[K("div",Ge,[K("label",He,[I(m,{content:"为注册的用户分配默认的权限",placement:"top"},{default:J(()=>[K("span",null,[I(d,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),t[14]||(t[14]=K("span",{class:"ms-1"},"分配权限：",-1))])]),_:1})]),I(g,{modelValue:R(r).item.auth,"onUpdate:modelValue":t[3]||(t[3]=s=>R(r).item.auth=s),"reserve-keyword":!1,"default-first-option":"","collapse-tags-tooltip":"","allow-create":"",multiple:"",filterable:"","collapse-tags":"",class:"d-block custom font-13",placeholder:"选择注册的默认权限"},{default:J(()=>[(U(!0),O(E,null,P(R(r).select.auth,s=>(U(),D(f,{key:s.id,label:s.name,value:s.id,class:"d-flex justify-content-between"},{default:J(()=>[K("span",Ye,[I(d,{name:"dot",color:s.color,size:"20px"},null,8,["color"]),A(" "+T(s.name),1)]),K("small",Qe,T(s.key),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])])])])]),footer:J(()=>[I(b,{onClick:t[4]||(t[4]=s=>R(r).status.dialog=!1)},{default:J(()=>[...t[15]||(t[15]=[A("取 消",-1)])]),_:1}),I(b,{onClick:t[5]||(t[5]=s=>u.save()),loading:R(r).status.wait},{default:J(()=>[...t[16]||(t[16]=[A("保 存",-1)])]),_:1},8,["loading"])]),_:1},8,["modelValue"])],64)}}},sa={class:"card mb-3"},ea={class:"card-body"},aa={class:"text-muted text-uppercase mt-0"},ta={class:"d-inline-flex align-items-center"},la={class:"m-b-20"},na={class:"text-muted ms-1"},oa={class:"row"},ca={class:"col-md-6"},ia={class:"form-group mb-3"},ra={class:"form-label required"},ua={class:"col-md-6"},da={class:"form-group mb-3"},ma={class:"form-label required"},pa={class:"col-md-6"},fa={class:"form-group mb-3"},ga={class:"form-label required"},ba={class:"col-md-6"},va={class:"form-group mb-3"},ha={class:"form-label required"},ya={__name:"jwt",setup(t,{expose:c}){const i=z({struct:{key:null,issuer:null,subject:null,expire:null},status:{active:!0,finish:!1,dialog:!1,loading:!0,wait:!1}});S(async()=>{await r.init()});const r={init:async()=>{i.status.finish=!1,i.status.loading=!0;const{code:s,data:e}=await v.get("/api/toml/crypt",{name:"jwt"});i.status.loading=!1,200===s&&(i.struct=e,i.status.finish=!0)},show(){if(!i.status.finish)return h.warn("分页限制配置获取失败，无法进行配置！");i.status.dialog=!0},change:async s=>{s||(i.status.active=!0,h.warn("？？？？？？？？？？？？？<br>JWT是基础服务，这可不许关"))},save:async()=>{i.status.wait=!0;const{code:s,msg:e}=await v.put("/api/toml/crypt-jwt",i.struct);if(i.status.wait=!1,200!==s)return h.error("保存失败："+e);i.status.dialog=!1},rand(s="key"){let e="INIS-";const a="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(let t=0;t<32;t++)e+=a.charAt(Math.floor(62*Math.random()));i.struct[s]=e}};return j(()=>i.struct,()=>{i.struct.key=i.struct.key.replace(/[^\w!@#$%^&*()_+\-=\[\]{};:'"\\|\/?,.<>~`\s]/g,""),i.struct.expire=i.struct.expire.replace(/[^\d\s*+\-\/]/g,"")},{deep:!0}),c({init:r.init}),(t,c)=>{const u=C("i-svg"),d=s,m=e,p=a,f=l,g=n,b=o;return U(),O(E,null,[q((U(),O("div",sa,[K("div",ea,[I(u,{name:"crypt",size:"55px",color:"rgb(var(--assist-color))",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),K("h6",aa,[I(d,{placement:"top"},{content:J(()=>[...c[10]||(c[10]=[A(" JWT（JSON Web Token）是一种在网络应用中传递声明信息的轻量级、安全的方式。",-1),K("br",null,null,-1),A(" JWT具有通用性和可扩展性，可以应用在很多场景，比如用户认证、单点登录、API访问授权等。 ",-1)])]),default:J(()=>[K("span",ta,[I(u,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),c[11]||(c[11]=K("span",{class:"ms-1"},"JWT",-1))])]),_:1})]),K("h2",la,[I(m,{modelValue:R(i).status.active,"onUpdate:modelValue":c[0]||(c[0]=s=>R(i).status.active=s),onChange:r.change,disabled:!R(i).status.finish,"active-text":"开始","inactive-text":"关闭"},null,8,["modelValue","onChange","disabled"])]),c[13]||(c[13]=K("span",{class:"badge bg-primary font-white"}," +5% ",-1)),K("span",na,[c[12]||(c[12]=A(" 安全性提升，",-1)),K("span",{onClick:c[1]||(c[1]=s=>r.show()),class:"text-dark pointer"},"点我配置")])])])),[[b,R(i).status.loading]]),I(g,{modelValue:R(i).status.dialog,"onUpdate:modelValue":c[9]||(c[9]=s=>R(i).status.dialog=s),class:"custom",draggable:"","close-on-click-modal":!1},{header:J(()=>[...c[14]||(c[14]=[K("strong",{class:"flex-center"},"配置 JSON Web Token",-1)])]),default:J(()=>[K("div",oa,[K("div",ca,[K("div",ia,[K("label",ra,[I(d,{content:"签发者，比如：萌卜兔",placement:"top"},{default:J(()=>[K("span",null,[I(u,{name:"hint",size:"14px"}),c[15]||(c[15]=K("span",{class:"ms-1"},"签发者：",-1))])]),_:1})]),I(p,{modelValue:R(i).struct.issuer,"onUpdate:modelValue":c[2]||(c[2]=s=>R(i).struct.issuer=s)},null,8,["modelValue"])])]),K("div",ua,[K("div",da,[K("label",ma,[I(d,{content:"主题，比如：萌卜兔",placement:"top"},{default:J(()=>[K("span",null,[I(u,{name:"hint",size:"14px"}),c[16]||(c[16]=K("span",{class:"ms-1"},"主题：",-1))])]),_:1})]),I(p,{modelValue:R(i).struct.subject,"onUpdate:modelValue":c[3]||(c[3]=s=>R(i).struct.subject=s)},null,8,["modelValue"])])]),K("div",pa,[K("div",fa,[K("label",ga,[I(d,{content:"生成JWT的密钥，建议复杂度高一些",placement:"top"},{default:J(()=>[K("span",null,[I(u,{name:"hint",size:"14px"}),c[17]||(c[17]=K("span",{class:"ms-1"},"密钥：",-1))])]),_:1})]),I(p,{modelValue:R(i).struct.key,"onUpdate:modelValue":c[5]||(c[5]=s=>R(i).struct.key=s),class:"custom",placeholder:"请输入验证码"},{suffix:J(()=>[I(f,{onClick:c[4]||(c[4]=s=>r.rand())},{default:J(()=>[I(u,{name:"restore",color:"rgb(var(--vice-color))",size:"14px"}),c[18]||(c[18]=K("span",{class:"ms-1"},"随机",-1))]),_:1})]),_:1},8,["modelValue"])])]),K("div",ba,[K("div",va,[K("label",ha,[I(d,{content:"签名有效期，可以用乘法，如：7 * 24 * 60 * 60 表示7天",placement:"top"},{default:J(()=>[K("span",null,[I(u,{name:"hint",size:"14px"}),c[19]||(c[19]=K("span",{class:"ms-1"},"过期时间(秒)：",-1))])]),_:1})]),I(p,{modelValue:R(i).struct.expire,"onUpdate:modelValue":c[6]||(c[6]=s=>R(i).struct.expire=s)},null,8,["modelValue"])])])])]),footer:J(()=>[I(f,{onClick:c[7]||(c[7]=s=>R(i).status.dialog=!1)},{default:J(()=>[...c[20]||(c[20]=[A("取 消",-1)])]),_:1}),I(f,{onClick:c[8]||(c[8]=s=>r.save()),loading:R(i).status.wait},{default:J(()=>[...c[21]||(c[21]=[A("保 存",-1)])]),_:1},8,["loading"])]),_:1},8,["modelValue"])],64)}}},wa={class:"card mb-3"},_a={class:"card-body"},xa={class:"text-muted mt-0"},ka={class:"d-inline-flex align-items-center"},Va={class:"m-b-20"},za={class:"text-muted"},Sa={class:"row"},ja={class:"col-md-4"},Ca={class:"form-group mb-3"},Ua={class:"form-label required"},Oa={class:"col-md-4"},qa={class:"form-group mb-3"},Ra={class:"form-label required"},Ka={class:"col-md-4"},Ia={class:"form-group mb-3"},Ja={class:"form-label required"},Aa={class:"font-13"},Na={class:"row"},Da={class:"col-md-4"},$a={class:"form-group mb-3"},Ea={class:"form-label"},Pa={class:"col-md-4"},Ta={class:"form-group mb-3"},La={class:"form-label"},Ma={class:"col-md-4"},Ba={class:"form-group mb-3"},Wa={class:"form-label"},Xa={__name:"cache-redis",emits:["refresh"],setup(r,{expose:u,emit:d}){const m=d,p=z({struct:{open:!1,default:null,host:"localhost",port:6379,database:0,password:"",prefix:"inis:",expire:"2 * 60 * 60"},status:{finish:!1,active:!1,dialog:!1,loading:!0,test:!1},backup:{}});S(async()=>{await f.init()});const f={init:async()=>{p.status.finish=!1,p.status.loading=!0;const{code:s,data:e}=await v.get("/api/toml/cache",{name:"redis"});p.status.loading=!1,200===s&&(p.struct=e,p.backup=JSON.parse(JSON.stringify(e)),p.status.finish=!0)},show(){if(!p.status.finish)return h.warn("配置获取失败，无法进行配置！");p.status.dialog=!0},change:async s=>{const{code:e,msg:a}=await v.put("/api/toml/cache-default",{value:"redis",open:s});if(200===e)return m("refresh","cache-file","cache-ram");p.status.active=!s,h.error(a)},save:async()=>{if(!y.object.equal(p.struct,p.backup,["host","port","database","password"]))return h.warn("请先完成测试连接");if(y.is.empty(p.struct.host))return h.warn("请填写 主机地址！");if(y.is.empty(p.struct.port))return h.warn("请填写 端口号！");if(y.is.empty(p.struct.database))return h.warn("请选择 数据库！");p.status.wait=!0;const{code:s,msg:e}=await v.put("/api/toml/cache-redis",p.struct);if(p.status.wait=!1,200!==s)return h.error("保存失败："+e);p.status.dialog=!1},test:async()=>{if(y.is.empty(p.struct.host))return h.warn("请填写 主机地址！");if(y.is.empty(p.struct.port))return h.warn("请填写 端口号！");if(y.is.empty(p.struct.database))return h.warn("请选择 数据库！");p.status.test=!0;const{code:s,msg:e,data:a}=await v.post("/api/toml/test-redis",p.struct);if(p.status.test=!1,200===s)return p.backup=JSON.parse(JSON.stringify(p.struct)),h.success(e);h.error(`${e}<br>${a}`)}};return j(()=>p.struct,()=>{p.status.active="redis"===p.struct.default&&p.struct.open},{deep:!0}),u({init:f.init}),(r,u)=>{const d=C("i-svg"),m=s,g=e,b=a,v=t,h=c,y=i,w=l,_=n,x=o;return U(),O(E,null,[q((U(),O("div",wa,[K("div",_a,[I(d,{name:"redis",color:"rgb(var(--assist-color))",size:"56px",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),K("h6",xa,[I(m,{placement:"top"},{content:J(()=>[...u[12]||(u[12]=[K("strong",{class:"text-success"},"推荐开启，有利于减少数据库和服务器的负担！",-1),K("br",null,null,-1),A(" 开启后会对API数据进行缓存，减少重复执行数据库操作以及对数据的运算，",-1),K("br",null,null,-1),A(" 从而提高API的响应速度，减少服务器的负担。",-1),K("br",null,null,-1),A(" PS：缓存数据会存储在专门的缓存数据库Redis中。 ",-1)])]),default:J(()=>[K("span",ka,[I(d,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),u[13]||(u[13]=K("span",{class:"ms-1"},"Redis 缓存",-1))])]),_:1})]),K("h2",Va,[I(g,{modelValue:R(p).status.active,"onUpdate:modelValue":u[0]||(u[0]=s=>R(p).status.active=s),onChange:f.change,disabled:!R(p).status.finish,"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue","onChange","disabled"])]),u[15]||(u[15]=K("span",{class:"badge bg-success font-white"}," +30% ",-1)),K("span",za,[u[14]||(u[14]=A(" 综合提升，",-1)),K("span",{onClick:u[1]||(u[1]=s=>f.show()),class:"text-dark pointer"},"点我配置")])])])),[[x,R(p).status.loading]]),I(_,{modelValue:R(p).status.dialog,"onUpdate:modelValue":u[11]||(u[11]=s=>R(p).status.dialog=s),class:"custom",draggable:"","close-on-click-modal":!1},{header:J(()=>[...u[16]||(u[16]=[K("strong",{class:"flex-center"},"配置 Redis 缓存服务",-1)])]),default:J(()=>[K("div",Sa,[K("div",ja,[K("div",Ca,[K("label",Ua,[I(m,{content:"主机地址，如：localhost",placement:"top"},{default:J(()=>[K("span",null,[I(d,{name:"hint",size:"14px"}),u[17]||(u[17]=K("span",{class:"ms-1"},"主机：",-1))])]),_:1})]),I(b,{modelValue:R(p).struct.host,"onUpdate:modelValue":u[2]||(u[2]=s=>R(p).struct.host=s)},null,8,["modelValue"])])]),K("div",Oa,[K("div",qa,[K("label",Ra,[I(m,{content:"端口号，如：6379",placement:"top"},{default:J(()=>[K("span",null,[I(d,{name:"hint",size:"14px"}),u[18]||(u[18]=K("span",{class:"ms-1"},"端口：",-1))])]),_:1})]),I(v,{modelValue:R(p).struct.port,"onUpdate:modelValue":u[3]||(u[3]=s=>R(p).struct.port=s),min:1,max:65535,class:"w-100 d-flex",style:{height:"28px"},"controls-position":"right"},null,8,["modelValue"])])]),K("div",Ka,[K("div",Ia,[K("label",Ja,[I(m,{content:"数据库索引，如：0",placement:"top"},{default:J(()=>[K("span",null,[I(d,{name:"hint",size:"14px"}),u[19]||(u[19]=K("span",{class:"ms-1"},"数据库：",-1))])]),_:1})]),I(y,{modelValue:R(p).struct.database,"onUpdate:modelValue":u[4]||(u[4]=s=>R(p).struct.database=s),placeholder:"请选择方式",class:"d-block custom font-13"},{default:J(()=>[(U(),O(E,null,P(16,(s,e)=>I(h,{key:e,label:e,value:e},{default:J(()=>[K("span",Aa,T(e),1)]),_:2},1032,["label","value"])),64))]),_:1},8,["modelValue"])])])]),K("div",Na,[K("div",Da,[K("div",$a,[K("label",Ea,[I(m,{content:"Redis密码，无密码为空即可",placement:"top"},{default:J(()=>[K("span",null,[I(d,{name:"hint",size:"14px"}),u[20]||(u[20]=K("span",{class:"ms-1"},"密码：",-1))])]),_:1})]),I(b,{modelValue:R(p).struct.password,"onUpdate:modelValue":u[5]||(u[5]=s=>R(p).struct.password=s),"show-password":"",placeholder:"无密码为空即可"},null,8,["modelValue"])])]),K("div",Pa,[K("div",Ta,[K("label",La,[I(m,{content:"缓存有效时间，建议2小时，即7200秒，0表示永不过期",placement:"top"},{default:J(()=>[K("span",null,[I(d,{name:"hint",size:"14px"}),u[21]||(u[21]=K("span",{class:"ms-1"},"过期时间（秒）：",-1))])]),_:1})]),I(b,{modelValue:R(p).struct.expire,"onUpdate:modelValue":u[6]||(u[6]=s=>R(p).struct.expire=s)},null,8,["modelValue"])])]),K("div",Ma,[K("div",Ba,[K("label",Wa,[I(m,{content:"每个Key固定的前缀，如：inis:",placement:"top"},{default:J(()=>[K("span",null,[I(d,{name:"hint",size:"14px"}),u[22]||(u[22]=K("span",{class:"ms-1"},"前缀：",-1))])]),_:1})]),I(b,{modelValue:R(p).struct.prefix,"onUpdate:modelValue":u[7]||(u[7]=s=>R(p).struct.prefix=s)},null,8,["modelValue"])])])])]),footer:J(()=>[I(w,{onClick:u[8]||(u[8]=s=>R(p).status.dialog=!1)},{default:J(()=>[...u[23]||(u[23]=[A("取 消",-1)])]),_:1}),I(w,{onClick:u[9]||(u[9]=s=>f.test()),loading:R(p).status.test},{default:J(()=>[R(p).status.test?$("",!0):(U(),D(d,{key:0,name:"connect",size:"14px"})),u[24]||(u[24]=K("span",{class:"ms-1"},"测试连接",-1))]),_:1},8,["loading"]),I(w,{onClick:u[10]||(u[10]=s=>f.save()),loading:R(p).status.wait},{default:J(()=>[...u[25]||(u[25]=[A("保 存",-1)])]),_:1},8,["loading"])]),_:1},8,["modelValue"])],64)}}},Fa={class:"card mb-3"},Ga={class:"card-body"},Ha={class:"text-muted mt-0"},Ya={class:"d-inline-flex align-items-center"},Qa={class:"m-b-20"},Za={class:"text-muted"},st={class:"row"},et={class:"col-md-4"},at={class:"form-group mb-3"},tt={class:"form-label"},lt={class:"col-md-4"},nt={class:"form-group mb-3"},ot={class:"form-label"},ct={class:"col-md-4"},it={class:"form-group mb-3"},rt={class:"form-label"},ut={__name:"cache-file",emits:["refresh"],setup(t,{expose:c,emit:i}){const r=i,u=z({struct:{open:!1,default:null,path:null,prefix:"inis_",expire:"2 * 60 * 60"},status:{finish:!1,active:!1,dialog:!1,loading:!0,wait:!1}});S(async()=>{await d.init()});const d={init:async()=>{u.status.finish=!1,u.status.loading=!0;const{code:s,data:e}=await v.get("/api/toml/cache",{name:"file"});u.status.loading=!1,200===s&&(u.struct=e,u.status.finish=!0)},show(){if(!u.status.finish)return h.warn("配置获取失败，无法进行配置！");u.status.dialog=!0},change:async s=>{const{code:e,msg:a}=await v.put("/api/toml/cache-default",{value:"file",open:s});if(200===e)return r("refresh","cache-redis","cache-ram");u.status.active=!s,h.error(a)},save:async()=>{if(y.is.empty(u.struct.path))return h.warn("请填写 缓存目录！");if(y.is.empty(u.struct.expire))return h.warn("请填写 过期时间！");if(y.is.empty(u.struct.prefix))return h.warn("请选择 缓存前缀！");u.status.wait=!0;const{code:s,msg:e}=await v.put("/api/toml/cache-file",u.struct);if(u.status.wait=!1,200!==s)return h.error("保存失败："+e);u.status.dialog=!1}};return j(()=>u.struct,()=>{u.status.active="file"===u.struct.default&&u.struct.open},{deep:!0}),c({init:d.init}),(t,c)=>{const i=C("i-svg"),r=s,m=e,p=a,f=l,g=n,b=o;return U(),O(E,null,[q((U(),O("div",Fa,[K("div",Ga,[I(i,{name:"file",color:"rgb(var(--assist-color))",size:"55px",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),K("h6",Ha,[I(r,{placement:"top"},{content:J(()=>[...c[8]||(c[8]=[K("strong",{class:"text-success"},"推荐开启，有利于减少数据库和服务器的负担！",-1),K("br",null,null,-1),A(" 开启后会对API数据进行缓存，减少重复执行数据库操作以及对数据的运算，",-1),K("br",null,null,-1),A(" 从而提高API的响应速度，减少服务器的负担。",-1),K("br",null,null,-1),A(" PS：缓存数据会通过文件的方式存储在服务器的 ",-1),K("code",null,"runtime/cache",-1),A(" 目录下。 ",-1)])]),default:J(()=>[K("span",Ya,[I(i,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),c[9]||(c[9]=K("span",{class:"ms-1"},"文件缓存",-1))])]),_:1})]),K("h2",Qa,[I(m,{modelValue:R(u).status.active,"onUpdate:modelValue":c[0]||(c[0]=s=>R(u).status.active=s),onChange:d.change,disabled:!R(u).status.finish,"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue","onChange","disabled"])]),c[11]||(c[11]=K("span",{class:"badge bg-success font-white"}," +20% ",-1)),K("span",Za,[c[10]||(c[10]=A(" 综合提升，",-1)),K("span",{onClick:c[1]||(c[1]=s=>d.show()),class:"text-dark pointer"},"点我配置")])])])),[[b,R(u).status.loading]]),I(g,{modelValue:R(u).status.dialog,"onUpdate:modelValue":c[7]||(c[7]=s=>R(u).status.dialog=s),class:"custom",draggable:"","close-on-click-modal":!1},{header:J(()=>[...c[12]||(c[12]=[K("strong",{class:"flex-center"},"配置 文件 缓存服务",-1)])]),default:J(()=>[K("div",st,[K("div",et,[K("div",at,[K("label",tt,[I(r,{content:"缓存文件存储到哪个目录下？推荐：runtime/cache",placement:"top"},{default:J(()=>[K("span",null,[I(i,{name:"hint",size:"14px"}),c[13]||(c[13]=K("span",{class:"ms-1"},"缓存目录：",-1))])]),_:1})]),I(p,{modelValue:R(u).struct.path,"onUpdate:modelValue":c[2]||(c[2]=s=>R(u).struct.path=s),placeholder:"缓存目录"},null,8,["modelValue"])])]),K("div",lt,[K("div",nt,[K("label",ot,[I(r,{content:"缓存有效时间，建议2小时，即7200秒，0表示永不过期",placement:"top"},{default:J(()=>[K("span",null,[I(i,{name:"hint",size:"14px"}),c[14]||(c[14]=K("span",{class:"ms-1"},"过期时间（秒）：",-1))])]),_:1})]),I(p,{modelValue:R(u).struct.expire,"onUpdate:modelValue":c[3]||(c[3]=s=>R(u).struct.expire=s)},null,8,["modelValue"])])]),K("div",ct,[K("div",it,[K("label",rt,[I(r,{content:"每个Key固定的前缀，推荐：inis_",placement:"top"},{default:J(()=>[K("span",null,[I(i,{name:"hint",size:"14px"}),c[15]||(c[15]=K("span",{class:"ms-1"},"前缀：",-1))])]),_:1})]),I(p,{modelValue:R(u).struct.prefix,"onUpdate:modelValue":c[4]||(c[4]=s=>R(u).struct.prefix=s)},null,8,["modelValue"])])])])]),footer:J(()=>[I(f,{onClick:c[5]||(c[5]=s=>R(u).status.dialog=!1)},{default:J(()=>[...c[16]||(c[16]=[A("取 消",-1)])]),_:1}),I(f,{onClick:c[6]||(c[6]=s=>d.save()),loading:R(u).status.wait},{default:J(()=>[...c[17]||(c[17]=[A("保 存",-1)])]),_:1},8,["loading"])]),_:1},8,["modelValue"])],64)}}},dt={class:"card mb-3"},mt={class:"card-body"},pt={class:"text-muted mt-0"},ft={class:"d-inline-flex align-items-center"},gt={class:"m-b-20"},bt={class:"text-muted"},vt={class:"row"},ht={class:"col-md-12"},yt={class:"form-group mb-3"},wt={class:"form-label"},_t={__name:"cache-ram",emits:["refresh"],setup(t,{expose:c,emit:i}){const r=i,u=z({struct:{open:!1,default:null,expire:"2 * 60 * 60"},status:{finish:!1,active:!1,dialog:!1,loading:!0,wait:!1}});S(async()=>{await d.init()});const d={init:async()=>{u.status.finish=!1,u.status.loading=!0;const{code:s,data:e}=await v.get("/api/toml/cache",{name:"ram"});u.status.loading=!1,200===s&&(u.struct=e,u.status.finish=!0)},show(){if(!u.status.finish)return h.warn("配置获取失败，无法进行配置！");u.status.dialog=!0},change:async s=>{const{code:e,msg:a}=await v.put("/api/toml/cache-default",{value:"ram",open:s});if(200===e)return r("refresh","cache-redis","cache-file");u.status.active=!s,h.error(a)},save:async()=>{if(y.is.empty(u.struct.expire))return h.warn("请填写 过期时间！");u.status.wait=!0;const{code:s,msg:e}=await v.put("/api/toml/cache-ram",u.struct);if(u.status.wait=!1,200!==s)return h.error("保存失败："+e);u.status.dialog=!1}};return j(()=>u.struct,()=>{u.status.active="ram"===u.struct.default&&u.struct.open},{deep:!0}),c({init:d.init}),(t,c)=>{const i=C("i-svg"),r=s,m=e,p=a,f=l,g=n,b=o;return U(),O(E,null,[q((U(),O("div",dt,[K("div",mt,[I(i,{name:"ram",color:"rgb(var(--assist-color))",size:"55px",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),K("h6",pt,[I(r,{placement:"top"},{content:J(()=>[...c[6]||(c[6]=[K("strong",{class:"text-success"},"推荐开启，有利于减少数据库和服务器的负担！",-1),K("br",null,null,-1),A(" 开启后会对API数据进行缓存，减少重复执行数据库操作以及对数据的运算，",-1),K("br",null,null,-1),A(" 从而提高API的响应速度，减少服务器的负担。",-1),K("br",null,null,-1),A(" PS：缓存数据会通过内存的方式存储在服务器的内存中。 ",-1)])]),default:J(()=>[K("span",ft,[I(i,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),c[7]||(c[7]=K("span",{class:"ms-1"},"内存缓存",-1))])]),_:1})]),K("h2",gt,[I(r,{content:"请不要作死，内存很宝贵，不要用在这种地方，除非你是本地环境或者不怕死",placement:"top"},{default:J(()=>[I(m,{modelValue:R(u).status.active,"onUpdate:modelValue":c[0]||(c[0]=s=>R(u).status.active=s),onChange:d.change,disabled:"","active-text":"开启","inactive-text":"关闭"},null,8,["modelValue","onChange"])]),_:1})]),c[9]||(c[9]=K("span",{class:"badge bg-success font-white"}," +20% ",-1)),K("span",bt,[c[8]||(c[8]=A(" 综合提升，",-1)),K("span",{onClick:c[1]||(c[1]=s=>d.show()),class:"text-dark pointer"},"点我配置")])])])),[[b,R(u).status.loading]]),I(g,{modelValue:R(u).status.dialog,"onUpdate:modelValue":c[5]||(c[5]=s=>R(u).status.dialog=s),class:"custom",draggable:"","close-on-click-modal":!1},{header:J(()=>[...c[10]||(c[10]=[K("strong",{class:"flex-center"},"配置 内存 缓存服务",-1)])]),default:J(()=>[K("div",vt,[K("div",ht,[K("div",yt,[K("label",wt,[I(r,{content:"缓存有效时间，建议2小时，即7200秒，0表示永不过期",placement:"top"},{default:J(()=>[K("span",null,[I(i,{name:"hint",size:"14px"}),c[11]||(c[11]=K("span",{class:"ms-1"},"过期时间（秒）：",-1))])]),_:1})]),I(p,{modelValue:R(u).struct.expire,"onUpdate:modelValue":c[2]||(c[2]=s=>R(u).struct.expire=s)},null,8,["modelValue"])])])])]),footer:J(()=>[I(f,{onClick:c[3]||(c[3]=s=>R(u).status.dialog=!1)},{default:J(()=>[...c[12]||(c[12]=[A("取 消",-1)])]),_:1}),I(f,{onClick:c[4]||(c[4]=s=>d.save()),loading:R(u).status.wait},{default:J(()=>[...c[13]||(c[13]=[A("保 存",-1)])]),_:1},8,["loading"])]),_:1},8,["modelValue"])],64)}}},xt={class:"card mb-3"},kt={class:"card-body"},Vt={class:"text-muted text-uppercase mt-0"},zt={class:"d-inline-flex align-items-center"},St={class:"m-b-20"},jt={class:"text-muted ms-1"},Ct={class:"row"},Ut={class:"col-6"},Ot={class:"form-group mb-3"},qt={class:"form-label required"},Rt={class:"col-md-6"},Kt={class:"form-group mb-3"},It={class:"form-label"},Jt={__name:"storage-local",emits:["refresh"],setup(t,{expose:c,emit:i}){const r=i,u=z({struct:{default:null,domain:null,path:"storage"},status:{active:!0,finish:!1,dialog:!1,loading:!0,wait:!1}});S(async()=>{await d.init()});const d={init:async()=>{u.status.finish=!1,u.status.loading=!0;const{code:s,data:e}=await v.get("/api/toml/storage",{name:"local"});u.status.loading=!1,200===s&&(u.struct=e,u.status.finish=!0)},show(){if(!u.status.finish)return h.warn("配置获取失败，无法进行配置！");u.status.dialog=!0},change:async s=>{if(!s)return u.status.active=!0;const{code:e,msg:a}=await v.put("/api/toml/storage-default",{value:s?"local":null});if(200===e)return r("refresh");u.status.active=!s,h.error(a)},save:async()=>{u.status.wait=!0;const{code:s,msg:e}=await v.put("/api/toml/storage-local",u.struct);if(u.status.wait=!1,200!==s)return h.error("保存失败："+e);u.status.dialog=!1}};return j(()=>u.struct,()=>{u.status.active="local"===u.struct.default},{deep:!0}),c({init:d.init}),(t,c)=>{const i=C("i-svg"),r=s,m=e,p=a,f=l,g=n,b=o;return U(),O(E,null,[q((U(),O("div",xt,[K("div",kt,[I(i,{name:"serve",color:"rgb(var(--assist-color))",size:"60px",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),K("h6",Vt,[I(r,{placement:"top"},{content:J(()=>[...c[7]||(c[7]=[A(" ● 本地存储是指将图片等资源文件存储到服务器本地，然后通过访问服务器的方式获取资源文件",-1),K("br",null,null,-1),A(" ● 本地存储的优点是不花钱，缺点是占用服务器空间和带宽 ",-1)])]),default:J(()=>[K("span",zt,[I(i,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),c[8]||(c[8]=K("span",{class:"ms-1"},"本地存储",-1))])]),_:1})]),K("h2",St,[I(m,{modelValue:R(u).status.active,"onUpdate:modelValue":c[0]||(c[0]=s=>R(u).status.active=s),onChange:d.change,disabled:!R(u).status.finish,"active-text":"开始","inactive-text":"关闭"},null,8,["modelValue","onChange","disabled"])]),c[10]||(c[10]=K("span",{class:"badge bg-dark font-white"}," 传统 ",-1)),K("span",jt,[c[9]||(c[9]=A(" 这个不花钱，",-1)),K("span",{onClick:c[1]||(c[1]=s=>d.show()),class:"text-dark pointer"},"点我配置")])])])),[[b,R(u).status.loading]]),I(g,{modelValue:R(u).status.dialog,"onUpdate:modelValue":c[6]||(c[6]=s=>R(u).status.dialog=s),class:"custom",draggable:"","close-on-click-modal":!1},{header:J(()=>[...c[11]||(c[11]=[K("strong",{class:"flex-center"},"配置本地存储",-1)])]),default:J(()=>[K("div",Ct,[K("div",Ut,[K("div",Ot,[K("label",qt,[I(r,{content:"自定义存储域名",placement:"top"},{default:J(()=>[K("span",null,[I(i,{name:"hint",size:"14px"}),c[12]||(c[12]=K("span",{class:"ms-1"},"域名：",-1))])]),_:1})]),I(p,{modelValue:R(u).struct.domain,"onUpdate:modelValue":c[2]||(c[2]=s=>R(u).struct.domain=s)},null,8,["modelValue"])])]),K("div",Rt,[K("div",Kt,[K("label",It,[I(r,{content:"存储在哪个目录下",placement:"top"},{default:J(()=>[K("span",null,[I(i,{name:"hint",size:"14px"}),c[13]||(c[13]=K("span",{class:"ms-1"},"存储目录：",-1))])]),_:1})]),I(p,{modelValue:R(u).struct.path,"onUpdate:modelValue":c[3]||(c[3]=s=>R(u).struct.path=s),placeholder:"如: storage"},null,8,["modelValue"])])])])]),footer:J(()=>[I(f,{onClick:c[4]||(c[4]=s=>R(u).status.dialog=!1)},{default:J(()=>[...c[14]||(c[14]=[A("取 消",-1)])]),_:1}),I(f,{onClick:c[5]||(c[5]=s=>d.save()),loading:R(u).status.wait},{default:J(()=>[...c[15]||(c[15]=[A("保 存",-1)])]),_:1},8,["loading"])]),_:1},8,["modelValue"])],64)}}},At={class:"card mb-3"},Nt={class:"card-body"},Dt={class:"text-muted text-uppercase mt-0"},$t={class:"d-inline-flex align-items-center"},Et={class:"m-b-20"},Pt={class:"text-muted ms-1"},Tt={class:"row"},Lt={class:"col-md-6"},Mt={class:"form-group mb-3"},Bt={class:"form-label required"},Wt={class:"col-md-6"},Xt={class:"form-group mb-3"},Ft={class:"form-label required"},Gt={class:"col-md-4"},Ht={class:"form-group mb-3"},Yt={class:"form-label required"},Qt={class:"font-13"},Zt={class:"text-muted float-end"},sl={class:"col-md-4"},el={class:"form-group mb-3"},al={class:"form-label required"},tl={class:"col-md-4"},ll={class:"form-group mb-3"},nl={class:"form-label"},ol={class:"col-md-12"},cl={class:"form-group mb-3"},il={class:"form-label"},rl={__name:"storage-oss",emits:["refresh"],setup(t,{expose:r,emit:u}){const d=u,m=z({struct:{path:"inis",default:null,domain:null,bucket:null,endpoint:null,access_key_id:null,access_key_secret:null},status:{active:!0,finish:!1,dialog:!1,loading:!0,wait:!1,test:!1},backup:{},select:{endpoint:[{value:"oss-cn-hangzhou.aliyuncs.com",label:"华东1（杭州）"},{value:"oss-cn-shanghai.aliyuncs.com",label:"华东2（上海）"},{value:"oss-cn-nanjing.aliyuncs.com",label:"华东5（南京-本地地域）"},{value:"oss-cn-fuzhou.aliyuncs.com",label:"华东6（福州-本地地域）"},{value:"oss-cn-qingdao.aliyuncs.com",label:"华北1（青岛）"},{value:"oss-cn-beijing.aliyuncs.com",label:"华北2（北京）"},{value:"oss-cn-zhangjiakou.aliyuncs.com",label:"华北 3（张家口）"},{value:"oss-cn-huhehaote.aliyuncs.com",label:"华北5（呼和浩特）"},{value:"oss-cn-wulanchabu.aliyuncs.com",label:"华北6（乌兰察布）"},{value:"oss-cn-shenzhen.aliyuncs.com",label:"华南1（深圳）"},{value:"oss-cn-heyuan.aliyuncs.com",label:"华南2（河源）"},{value:"oss-cn-guangzhou.aliyuncs.com",label:"华南3（广州）"},{value:"oss-cn-chengdu.aliyuncs.com",label:"西南1（成都）"},{value:"oss-cn-hongkong.aliyuncs.com",label:"中国香港"},{value:"oss-us-west-1.aliyuncs.com",label:"美国（硅谷）①"},{value:"oss-us-east-1.aliyuncs.com",label:"美国（弗吉尼亚）①"},{value:"oss-ap-northeast-1.aliyuncs.com",label:"日本（东京）①"},{value:"oss-ap-northeast-2.aliyuncs.com",label:"韩国（首尔）"},{value:"oss-ap-southeast-1.aliyuncs.com",label:"新加坡①"},{value:"oss-ap-southeast-2.aliyuncs.com",label:"澳大利亚（悉尼）①"},{value:"oss-ap-southeast-3.aliyuncs.com",label:"马来西亚（吉隆坡）①"},{value:"oss-ap-southeast-5.aliyuncs.com",label:"印度尼西亚（雅加达）①"},{value:"oss-ap-southeast-6.aliyuncs.com",label:"菲律宾（马尼拉）"},{value:"oss-ap-southeast-7.aliyuncs.com",label:"泰国（曼谷）"},{value:"oss-ap-south-1.aliyuncs.com",label:"印度（孟买）①"},{value:"oss-eu-central-1.aliyuncs.com",label:"德国（法兰克福）①"},{value:"oss-eu-west-1.aliyuncs.com",label:"英国（伦敦）"},{value:"oss-me-east-1.aliyuncs.com",label:"阿联酋（迪拜）①"},{value:"oss-rg-china-mainland.aliyuncs.com",label:"无地域属性（中国内地）"},{value:"oss-cn-hzfinance.aliyuncs.com",label:"杭州金融云公网"},{value:"oss-cn-shanghai-finance-1-pub.aliyuncs.com",label:"上海金融云公网"},{value:"oss-cn-szfinance.aliyuncs.com",label:"深圳金融云公网"},{value:"oss-cn-beijing-finance-1-pub.aliyuncs.com",label:"北京金融云公网"}]}});S(async()=>{await p.init()});const p={init:async()=>{m.status.finish=!1,m.status.loading=!0;const{code:s,data:e}=await v.get("/api/toml/storage",{name:"oss"});m.status.loading=!1,200===s&&(m.struct=e,m.backup=JSON.parse(JSON.stringify(e)),m.status.finish=!0)},show(){if(!m.status.finish)return h.warn("存储配置获取失败，无法进行配置！");m.status.dialog=!0},change:async s=>{if(!s)return m.status.active=!0;const{code:e,msg:a}=await v.put("/api/toml/storage-default",{value:s?"oss":null});if(200===e)return d("refresh");m.status.active=!s,h.error(a)},save:async()=>{if(!y.object.equal(m.struct,m.backup,["access_key_id","access_key_secret","endpoint","bucket"]))return h.warn("请先OSS连接测试");if(y.is.empty(m.struct.access_key_id))return h.warn("请填写 AccessKey ID！");if(y.is.empty(m.struct.access_key_secret))return h.warn("请填写 AccessKey Secret！");if(y.is.empty(m.struct.endpoint))return h.warn("请填写 Endpoint！");if(y.is.empty(m.struct.bucket))return h.warn("请填写 Bucket！");m.status.wait=!0;const{code:s,msg:e}=await v.put("/api/toml/storage-oss",m.struct);if(m.status.wait=!1,200!==s)return h.error("保存失败："+e);m.status.dialog=!1},test:async()=>{if(y.is.empty(m.struct.access_key_id))return h.warn("请填写 AccessKey ID！");if(y.is.empty(m.struct.access_key_secret))return h.warn("请填写 AccessKey Secret！");if(y.is.empty(m.struct.endpoint))return h.warn("请填写 Endpoint！");if(y.is.empty(m.struct.bucket))return h.warn("请填写 Bucket！");m.status.test=!0;const{code:s,msg:e,data:a}=await v.post("/api/toml/test-oss",m.struct);if(m.status.test=!1,200===s)return m.backup=JSON.parse(JSON.stringify(m.struct)),h.success(e);h.error(`${e}<br>${a}`)}};return j(()=>m.struct,()=>{m.status.active="oss"===m.struct.default},{deep:!0}),r({init:p.init}),(t,r)=>{const u=C("i-svg"),d=s,f=e,g=a,b=c,v=i,h=l,y=n,w=o;return U(),O(E,null,[q((U(),O("div",At,[K("div",Nt,[I(u,{name:"aliyun",color:"rgb(var(--assist-color))",size:"60px",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),K("h6",Dt,[I(d,{placement:"top"},{content:J(()=>[...r[12]||(r[12]=[A(" ● OSS可以替代传统的本地存储，有能力的情况推荐开启OSS存储",-1),K("br",null,null,-1),A(" ● 开启后，后续上传的文件将会自动上传到OSS，不会占用服务器的空间和带宽 ",-1)])]),default:J(()=>[K("span",$t,[I(u,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),r[13]||(r[13]=K("span",{class:"ms-1"},"OSS",-1))])]),_:1})]),K("h2",Et,[I(f,{modelValue:R(m).status.active,"onUpdate:modelValue":r[0]||(r[0]=s=>R(m).status.active=s),onChange:p.change,disabled:!R(m).status.finish,"active-text":"开始","inactive-text":"关闭"},null,8,["modelValue","onChange","disabled"])]),r[15]||(r[15]=K("span",{class:"badge bg-warning font-white"}," 推荐 ",-1)),K("span",Pt,[r[14]||(r[14]=A(" 这个还不错，",-1)),K("span",{onClick:r[1]||(r[1]=s=>p.show()),class:"text-dark pointer"},"点我配置")])])])),[[w,R(m).status.loading]]),I(y,{modelValue:R(m).status.dialog,"onUpdate:modelValue":r[11]||(r[11]=s=>R(m).status.dialog=s),class:"custom",draggable:"","close-on-click-modal":!1},{header:J(()=>[...r[16]||(r[16]=[K("strong",{class:"flex-center"},"配置 阿里云OSS 存储",-1)])]),default:J(()=>[K("div",Tt,[K("div",Lt,[K("div",Mt,[K("label",Bt,[I(d,{content:"阿里云 AccessKey ID",placement:"top"},{default:J(()=>[K("span",null,[I(u,{name:"hint",size:"14px"}),r[17]||(r[17]=K("span",{class:"ms-1"},"AccessKey ID：",-1))])]),_:1})]),I(g,{modelValue:R(m).struct.access_key_id,"onUpdate:modelValue":r[2]||(r[2]=s=>R(m).struct.access_key_id=s),"show-password":""},null,8,["modelValue"])])]),K("div",Wt,[K("div",Xt,[K("label",Ft,[I(d,{content:"阿里云AccessKey Secret",placement:"top"},{default:J(()=>[K("span",null,[I(u,{name:"hint",size:"14px"}),r[18]||(r[18]=K("span",{class:"ms-1"},"AccessKey Secret：",-1))])]),_:1})]),I(g,{modelValue:R(m).struct.access_key_secret,"onUpdate:modelValue":r[3]||(r[3]=s=>R(m).struct.access_key_secret=s),"show-password":""},null,8,["modelValue"])])]),K("div",Gt,[K("div",Ht,[K("label",Yt,[I(d,{content:"OSS 外网 Endpoint",placement:"top"},{default:J(()=>[K("span",null,[I(u,{name:"hint",size:"14px"}),r[19]||(r[19]=K("span",{class:"ms-1"},"Endpoint：",-1))])]),_:1})]),I(v,{modelValue:R(m).struct.endpoint,"onUpdate:modelValue":r[4]||(r[4]=s=>R(m).struct.endpoint=s),placeholder:"请选择所在地区",class:"d-block custom font-13"},{default:J(()=>[(U(!0),O(E,null,P(R(m).select.endpoint,s=>(U(),D(b,{key:s.value,label:s.label,value:s.value},{default:J(()=>[K("span",Qt,T(s.label),1),K("small",Zt,T(s.value),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])])]),K("div",sl,[K("div",el,[K("label",al,[I(d,{content:"存储桶名称",placement:"top"},{default:J(()=>[K("span",null,[I(u,{name:"hint",size:"14px"}),r[20]||(r[20]=K("span",{class:"ms-1"},"OSS Bucket：",-1))])]),_:1})]),I(g,{modelValue:R(m).struct.bucket,"onUpdate:modelValue":r[5]||(r[5]=s=>R(m).struct.bucket=s)},null,8,["modelValue"])])]),K("div",tl,[K("div",ll,[K("label",nl,[I(d,{content:"存储在哪个目录下",placement:"top"},{default:J(()=>[K("span",null,[I(u,{name:"hint",size:"14px"}),r[21]||(r[21]=K("span",{class:"ms-1"},"存储目录：",-1))])]),_:1})]),I(g,{modelValue:R(m).struct.path,"onUpdate:modelValue":r[6]||(r[6]=s=>R(m).struct.path=s),placeholder:"如: inis"},null,8,["modelValue"])])]),K("div",ol,[K("div",cl,[K("label",il,[I(d,{content:"用于访问 - 不填写则使用默认域名",placement:"top"},{default:J(()=>[K("span",null,[I(u,{name:"hint",size:"14px"}),r[22]||(r[22]=K("span",{class:"ms-1"},"OSS 外网域名：",-1))])]),_:1})]),I(g,{modelValue:R(m).struct.domain,"onUpdate:modelValue":r[7]||(r[7]=s=>R(m).struct.domain=s)},null,8,["modelValue"])])])])]),footer:J(()=>[I(h,{onClick:r[8]||(r[8]=s=>R(m).status.dialog=!1)},{default:J(()=>[...r[23]||(r[23]=[A("取 消",-1)])]),_:1}),I(h,{onClick:r[9]||(r[9]=s=>p.test()),loading:R(m).status.test},{default:J(()=>[R(m).status.test?$("",!0):(U(),D(u,{key:0,name:"connect",size:"14px"})),r[24]||(r[24]=K("span",{class:"ms-1"},"测试连接",-1))]),_:1},8,["loading"]),I(h,{onClick:r[10]||(r[10]=s=>p.save()),loading:R(m).status.wait},{default:J(()=>[...r[25]||(r[25]=[A("保 存",-1)])]),_:1},8,["loading"])]),_:1},8,["modelValue"])],64)}}},ul={class:"card mb-3"},dl={class:"card-body"},ml={class:"text-muted text-uppercase mt-0"},pl={class:"d-inline-flex align-items-center"},fl={class:"m-b-20"},gl={class:"text-muted ms-1"},bl={class:"row"},vl={class:"col-md-6"},hl={class:"form-group mb-3"},yl={class:"form-label required"},wl={class:"col-md-6"},_l={class:"form-group mb-3"},xl={class:"form-label required"},kl={class:"col-md-6"},Vl={class:"form-group mb-3"},zl={class:"form-label required"},Sl={class:"col-md-6"},jl={class:"form-group mb-3"},Cl={class:"form-label required"},Ul={class:"col-md-3"},Ol={class:"form-group mb-3"},ql={class:"form-label required"},Rl={class:"font-13"},Kl={class:"text-muted float-end"},Il={class:"col-md-3"},Jl={class:"form-group mb-3"},Al={class:"form-label"},Nl={class:"col-md-6"},Dl={class:"form-group mb-3"},$l={class:"form-label"},El={__name:"storage-cos",emits:["refresh"],setup(t,{expose:r,emit:u}){const d=u,m=z({struct:{path:"inis",default:null,domain:null,app_id:null,bucket:null,region:null,secret_id:null,secret_key:null},status:{active:!0,finish:!1,dialog:!1,loading:!0,wait:!1,test:!1},backup:{},select:{region:[{value:"ap-beijing-1",label:"北京一区",area:"中国大陆"},{value:"ap-beijing",label:"北京",area:"中国大陆"},{value:"ap-nanjing",label:"南京",area:"中国大陆"},{value:"ap-shanghai",label:"上海",area:"中国大陆"},{value:"ap-guangzhou",label:"广州",area:"中国大陆"},{value:"ap-chengdu",label:"成都",area:"中国大陆"},{value:"ap-chongqing",label:"重庆",area:"中国大陆"},{value:"ap-shenzhen-fsi",label:"深圳金融",area:"中国大陆"},{value:"ap-shanghai-fsi",label:"上海金融",area:"中国大陆"},{value:"ap-beijing-fsi",label:"北京金融",area:"中国大陆"},{value:"ap-hongkong",label:"中国香港",area:"亚太"},{value:"ap-singapore",label:"新加坡",area:"亚太"},{value:"ap-mumbai",label:"孟买",area:"亚太"},{value:"ap-jakarta",label:"雅加达",area:"亚太"},{value:"ap-seoul",label:"首尔",area:"亚太"},{value:"ap-bangkok",label:"曼谷",area:"亚太"},{value:"ap-tokyo",label:"东京",area:"亚太"},{value:"na-siliconvalley",label:"硅谷（美西）",area:"北美"},{value:"na-ashburn",label:"弗吉尼亚（美东）",area:"北美"},{value:"na-toronto",label:"多伦多",area:"北美"},{value:"sa-saopaulo",label:"圣保罗",area:"南美"},{value:"eu-frankfurt",label:"法兰克福",area:"欧洲"}]}});S(async()=>{await p.init()});const p={init:async()=>{m.status.finish=!1,m.status.loading=!0;const{code:s,data:e}=await v.get("/api/toml/storage",{name:"cos"});m.status.loading=!1,200===s&&(m.struct=e,m.backup=JSON.parse(JSON.stringify(e)),m.status.finish=!0)},show(){if(!m.status.finish)return h.warn("配置获取失败，无法进行配置！");m.status.dialog=!0},change:async s=>{if(!s)return m.status.active=!0;const{code:e,msg:a}=await v.put("/api/toml/storage-default",{value:s?"cos":null});if(200===e)return d("refresh");m.status.active=!s,h.error(a)},save:async()=>{if(!y.object.equal(m.struct,m.backup,["secret_id","secret_key","app_id","region","bucket"]))return h.warn("请先OSS连接测试");if(y.is.empty(m.struct.secret_id))return h.warn("请填写 SecretId！");if(y.is.empty(m.struct.secret_key))return h.warn("请填写 SecretKey！");if(y.is.empty(m.struct.app_id))return h.warn("请填写 AppId！");if(y.is.empty(m.struct.region))return h.warn("请填写 Bucket！");if(y.is.empty(m.struct.bucket))return h.warn("请填写 Region！");m.status.wait=!0;const{code:s,msg:e}=await v.put("/api/toml/storage-cos",m.struct);if(m.status.wait=!1,200!==s)return h.error("保存失败："+e);m.status.dialog=!1},test:async()=>{if(y.is.empty(m.struct.secret_id))return h.warn("请填写 SecretId！");if(y.is.empty(m.struct.secret_key))return h.warn("请填写 SecretKey！");if(y.is.empty(m.struct.app_id))return h.warn("请填写 AppId！");if(y.is.empty(m.struct.region))return h.warn("请填写 Bucket！");if(y.is.empty(m.struct.bucket))return h.warn("请填写 Region！");m.status.test=!0;const{code:s,msg:e,data:a}=await v.post("/api/toml/test-cos",m.struct);if(m.status.test=!1,200===s)return m.backup=JSON.parse(JSON.stringify(m.struct)),h.success(e);h.error(`${e}<br>${a}`)}};return j(()=>m.struct,()=>{m.status.active="cos"===m.struct.default},{deep:!0}),r({init:p.init}),(t,r)=>{const u=C("i-svg"),d=s,f=e,g=a,b=c,v=i,h=l,y=n,w=o;return U(),O(E,null,[q((U(),O("div",ul,[K("div",dl,[I(u,{name:"tencent",color:"rgb(var(--assist-color))",size:"60px",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),K("h6",ml,[I(d,{placement:"top"},{content:J(()=>[...r[13]||(r[13]=[A(" ● COS可以替代传统的本地存储，有能力的情况推荐开启COS存储",-1),K("br",null,null,-1),A(" ● 开启后，后续上传的文件将会自动上传到COS，不会占用服务器的空间和带宽 ",-1)])]),default:J(()=>[K("span",pl,[I(u,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),r[14]||(r[14]=K("span",{class:"ms-1"},"COS",-1))])]),_:1})]),K("h2",fl,[I(f,{modelValue:R(m).status.active,"onUpdate:modelValue":r[0]||(r[0]=s=>R(m).status.active=s),onChange:p.change,disabled:!R(m).status.finish,"active-text":"开始","inactive-text":"关闭"},null,8,["modelValue","onChange","disabled"])]),r[16]||(r[16]=K("span",{class:"badge bg-primary font-white"}," 推荐 ",-1)),K("span",gl,[r[15]||(r[15]=A(" 这个也不错，",-1)),K("span",{onClick:r[1]||(r[1]=s=>p.show()),class:"text-dark pointer"},"点我配置")])])])),[[w,R(m).status.loading]]),I(y,{modelValue:R(m).status.dialog,"onUpdate:modelValue":r[12]||(r[12]=s=>R(m).status.dialog=s),class:"custom",draggable:"","close-on-click-modal":!1},{header:J(()=>[...r[17]||(r[17]=[K("strong",{class:"flex-center"},"配置 腾讯云COS 存储",-1)])]),default:J(()=>[K("div",bl,[K("div",vl,[K("div",hl,[K("label",yl,[I(d,{content:"腾讯云COS SecretId",placement:"top"},{default:J(()=>[K("span",null,[I(u,{name:"hint",size:"14px"}),r[18]||(r[18]=K("span",{class:"ms-1"},"SecretId：",-1))])]),_:1})]),I(g,{modelValue:R(m).struct.secret_id,"onUpdate:modelValue":r[2]||(r[2]=s=>R(m).struct.secret_id=s),"show-password":""},null,8,["modelValue"])])]),K("div",wl,[K("div",_l,[K("label",xl,[I(d,{content:"腾讯云COS SecretKey",placement:"top"},{default:J(()=>[K("span",null,[I(u,{name:"hint",size:"14px"}),r[19]||(r[19]=K("span",{class:"ms-1"},"SecretKey：",-1))])]),_:1})]),I(g,{modelValue:R(m).struct.secret_key,"onUpdate:modelValue":r[3]||(r[3]=s=>R(m).struct.secret_key=s),"show-password":""},null,8,["modelValue"])])]),K("div",kl,[K("div",Vl,[K("label",zl,[I(d,{content:"腾讯云COS AppId",placement:"top"},{default:J(()=>[K("span",null,[I(u,{name:"hint",size:"14px"}),r[20]||(r[20]=K("span",{class:"ms-1"},"AppId：",-1))])]),_:1})]),I(g,{modelValue:R(m).struct.app_id,"onUpdate:modelValue":r[4]||(r[4]=s=>R(m).struct.app_id=s)},null,8,["modelValue"])])]),K("div",Sl,[K("div",jl,[K("label",Cl,[I(d,{content:"存储桶名称",placement:"top"},{default:J(()=>[K("span",null,[I(u,{name:"hint",size:"14px"}),r[21]||(r[21]=K("span",{class:"ms-1"},"COS Bucket：",-1))])]),_:1})]),I(g,{modelValue:R(m).struct.bucket,"onUpdate:modelValue":r[5]||(r[5]=s=>R(m).struct.bucket=s)},null,8,["modelValue"])])]),K("div",Ul,[K("div",Ol,[K("label",ql,[I(d,{content:"所在地区，如这里的 ap-guangzhou（广州）",placement:"top"},{default:J(()=>[K("span",null,[I(u,{name:"hint",size:"14px"}),r[22]||(r[22]=K("span",{class:"ms-1"},"COS Region：",-1))])]),_:1})]),I(v,{modelValue:R(m).struct.region,"onUpdate:modelValue":r[6]||(r[6]=s=>R(m).struct.region=s),placeholder:"请选择所在地区",class:"d-block custom font-13"},{default:J(()=>[(U(!0),O(E,null,P(R(m).select.region,s=>(U(),D(b,{key:s.value,label:s.label,value:s.value},{default:J(()=>[K("span",Rl,T(s.label),1),K("small",Kl,T(s.value)+" | "+T(s.area),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])])]),K("div",Il,[K("div",Jl,[K("label",Al,[I(d,{content:"存储在哪个目录下",placement:"top"},{default:J(()=>[K("span",null,[I(u,{name:"hint",size:"14px"}),r[23]||(r[23]=K("span",{class:"ms-1"},"存储目录：",-1))])]),_:1})]),I(g,{modelValue:R(m).struct.path,"onUpdate:modelValue":r[7]||(r[7]=s=>R(m).struct.path=s),placeholder:"如: inis"},null,8,["modelValue"])])]),K("div",Nl,[K("div",Dl,[K("label",$l,[I(d,{content:"用于访问 - 不填写则使用默认域名",placement:"top"},{default:J(()=>[K("span",null,[I(u,{name:"hint",size:"14px"}),r[24]||(r[24]=K("span",{class:"ms-1"},"COS 外网域名：",-1))])]),_:1})]),I(g,{modelValue:R(m).struct.domain,"onUpdate:modelValue":r[8]||(r[8]=s=>R(m).struct.domain=s)},null,8,["modelValue"])])])])]),footer:J(()=>[I(h,{onClick:r[9]||(r[9]=s=>R(m).status.dialog=!1)},{default:J(()=>[...r[25]||(r[25]=[A("取 消",-1)])]),_:1}),I(h,{onClick:r[10]||(r[10]=s=>p.test()),loading:R(m).status.test},{default:J(()=>[R(m).status.test?$("",!0):(U(),D(u,{key:0,name:"connect",size:"14px"})),r[26]||(r[26]=K("span",{class:"ms-1"},"测试连接",-1))]),_:1},8,["loading"]),I(h,{onClick:r[11]||(r[11]=s=>p.save()),loading:R(m).status.wait},{default:J(()=>[...r[27]||(r[27]=[A("保 存",-1)])]),_:1},8,["loading"])]),_:1},8,["modelValue"])],64)}}},Pl={class:"card mb-3"},Tl={class:"card-body"},Ll={class:"text-muted text-uppercase mt-0"},Ml={class:"d-inline-flex align-items-center"},Bl={class:"m-b-20"},Wl={class:"text-muted ms-1"},Xl={class:"row"},Fl={class:"col-md-6"},Gl={class:"form-group mb-3"},Hl={class:"form-label required"},Yl={class:"col-md-6"},Ql={class:"form-group mb-3"},Zl={class:"form-label required"},sn={class:"col-md-6"},en={class:"form-group mb-3"},an={class:"form-label required"},tn={class:"col-md-6"},ln={class:"form-group mb-3"},nn={class:"form-label required"},on={class:"font-13"},cn={class:"text-muted float-end"},rn={class:"col-md-12"},un={class:"form-group mb-3"},dn={class:"form-label required"},mn={__name:"storage-kodo",emits:["refresh"],setup(t,{expose:u,emit:d}){const m=d,p=z({struct:{default:null,domain:null,access_key:null,secret_key:null,bucket:null,region:null},status:{active:!0,finish:!1,dialog:!1,loading:!0,wait:!1,test:!1},backup:{},select:{region:[{value:"z0",label:"华东"},{value:"z1",label:"华北河北"},{value:"z2",label:"华南广东"},{value:"na0",label:"北美"},{value:"as0",label:"新加坡"},{value:"cn-east-2",label:"华东浙江"},{value:"ap-northeast-1",label:"亚太-首尔机房"}]}});S(async()=>{await f.init()});const f={init:async()=>{p.status.finish=!1,p.status.loading=!0;const{code:s,data:e}=await v.get("/api/toml/storage",{name:"kodo"});p.status.loading=!1,200===s&&(p.struct=e,p.backup=JSON.parse(JSON.stringify(e)),p.status.finish=!0)},show(){if(!p.status.finish)return h.warn("配置获取失败，无法进行配置！");p.status.dialog=!0},change:async s=>{if(!s)return p.status.active=!0;const{code:e,msg:a}=await v.put("/api/toml/storage-default",{value:s?"kodo":null});if(200===e)return m("refresh");p.status.active=!s,h.error(a)},save:async()=>{if(!y.object.equal(p.struct,p.backup,["access_key","secret_key","bucket","region"]))return h.warn("请先KODO连接测试");if(y.is.empty(p.struct.access_key))return h.warn("请填写 AccessKey！");if(y.is.empty(p.struct.secret_key))return h.warn("请填写 SecretKey！");if(y.is.empty(p.struct.bucket))return h.warn("请填写 Bucket！");if(y.is.empty(p.struct.region))return h.warn("请填写 Region！");if(y.is.empty(p.struct.domain))return h.warn("请填写 外网域名！");p.status.wait=!0;const{code:s,msg:e}=await v.put("/api/toml/storage-kodo",p.struct);if(p.status.wait=!1,200!==s)return h.error("保存失败："+e);p.status.dialog=!1},test:async()=>{if(y.is.empty(p.struct.access_key))return h.warn("请填写 AccessKey！");if(y.is.empty(p.struct.secret_key))return h.warn("请填写 SecretKey！");if(y.is.empty(p.struct.bucket))return h.warn("请填写 Bucket！");if(y.is.empty(p.struct.region))return h.warn("请填写 Region！");p.status.test=!0;const{code:s,msg:e,data:a}=await v.post("/api/toml/test-kodo",p.struct);if(p.status.test=!1,200===s)return p.backup=JSON.parse(JSON.stringify(p.struct)),h.success(e);h.error(`${e}<br>${a}`)}};return j(()=>p.struct,()=>{p.status.active="kodo"===p.struct.default},{deep:!0}),u({init:f.init}),(t,u)=>{const d=r,m=C("i-svg"),g=s,b=e,v=a,h=c,y=i,w=l,_=n,x=o;return U(),O(E,null,[q((U(),O("div",Pl,[K("div",Tl,[I(d,{src:"/assets/imgs/png/qiniu.png",class:"position-absolute opacity-25",style:{right:"1.5rem",height:"65px"}}),K("h6",Ll,[I(g,{placement:"top"},{content:J(()=>[...u[11]||(u[11]=[A(" ● KODO可以替代传统的本地存储，有能力的情况推荐开启KODO存储（但是总体体验上比OSS和COS略差）",-1),K("br",null,null,-1),A(" ● 开启后，后续上传的文件将会自动上传到KODO，不会占用服务器的空间和带宽 ",-1)])]),default:J(()=>[K("span",Ml,[I(m,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),u[12]||(u[12]=K("span",{class:"ms-1"},"KODO",-1))])]),_:1})]),K("h2",Bl,[I(b,{modelValue:R(p).status.active,"onUpdate:modelValue":u[0]||(u[0]=s=>R(p).status.active=s),onChange:f.change,disabled:!R(p).status.finish,"active-text":"开始","inactive-text":"关闭"},null,8,["modelValue","onChange","disabled"])]),u[14]||(u[14]=K("span",{class:"badge bg-info font-white"}," 一般 ",-1)),K("span",Wl,[u[13]||(u[13]=A(" 不是很好用，",-1)),K("span",{onClick:u[1]||(u[1]=s=>f.show()),class:"text-dark pointer"},"点我配置")])])])),[[x,R(p).status.loading]]),I(_,{modelValue:R(p).status.dialog,"onUpdate:modelValue":u[10]||(u[10]=s=>R(p).status.dialog=s),class:"custom",draggable:"","close-on-click-modal":!1},{header:J(()=>[...u[15]||(u[15]=[K("strong",{class:"flex-center"},"配置 七牛云KODO 存储",-1)])]),default:J(()=>[K("div",Xl,[K("div",Fl,[K("div",Gl,[K("label",Hl,[I(g,{content:"七牛云AccessKey",placement:"top"},{default:J(()=>[K("span",null,[I(m,{name:"hint",size:"14px"}),u[16]||(u[16]=K("span",{class:"ms-1"},"AccessKey：",-1))])]),_:1})]),I(v,{modelValue:R(p).struct.access_key,"onUpdate:modelValue":u[2]||(u[2]=s=>R(p).struct.access_key=s),"show-password":""},null,8,["modelValue"])])]),K("div",Yl,[K("div",Ql,[K("label",Zl,[I(g,{content:"七牛云SecretKey",placement:"top"},{default:J(()=>[K("span",null,[I(m,{name:"hint",size:"14px"}),u[17]||(u[17]=K("span",{class:"ms-1"},"SecretKey：",-1))])]),_:1})]),I(v,{modelValue:R(p).struct.secret_key,"onUpdate:modelValue":u[3]||(u[3]=s=>R(p).struct.secret_key=s),"show-password":""},null,8,["modelValue"])])]),K("div",sn,[K("div",en,[K("label",an,[I(g,{content:"存储桶名称",placement:"top"},{default:J(()=>[K("span",null,[I(m,{name:"hint",size:"14px"}),u[18]||(u[18]=K("span",{class:"ms-1"},"Bucket：",-1))])]),_:1})]),I(v,{modelValue:R(p).struct.bucket,"onUpdate:modelValue":u[4]||(u[4]=s=>R(p).struct.bucket=s)},null,8,["modelValue"])])]),K("div",tn,[K("div",ln,[K("label",nn,[I(g,{content:"KODO 所在地区",placement:"top"},{default:J(()=>[K("span",null,[I(m,{name:"hint",size:"14px"}),u[19]||(u[19]=K("span",{class:"ms-1"},"Region：",-1))])]),_:1})]),I(y,{modelValue:R(p).struct.region,"onUpdate:modelValue":u[5]||(u[5]=s=>R(p).struct.region=s),placeholder:"请选择所在地区",class:"d-block custom font-13"},{default:J(()=>[(U(!0),O(E,null,P(R(p).select.region,s=>(U(),D(h,{key:s.value,label:s.label,value:s.value},{default:J(()=>[K("span",on,T(s.label),1),K("small",cn,T(s.value),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])])]),K("div",rn,[K("div",un,[K("label",dn,[I(g,{content:"（必须）外网域名 - 用于访问",placement:"top"},{default:J(()=>[K("span",null,[I(m,{name:"hint",size:"14px"}),u[20]||(u[20]=K("span",{class:"ms-1"},"外网域名：",-1))])]),_:1})]),I(v,{modelValue:R(p).struct.domain,"onUpdate:modelValue":u[6]||(u[6]=s=>R(p).struct.domain=s)},null,8,["modelValue"])])])])]),footer:J(()=>[I(w,{onClick:u[7]||(u[7]=s=>R(p).status.dialog=!1)},{default:J(()=>[...u[21]||(u[21]=[A("取 消",-1)])]),_:1}),I(w,{onClick:u[8]||(u[8]=s=>f.test()),loading:R(p).status.test},{default:J(()=>[R(p).status.test?$("",!0):(U(),D(m,{key:0,name:"connect",size:"14px"})),u[22]||(u[22]=K("span",{class:"ms-1"},"测试连接",-1))]),_:1},8,["loading"]),I(w,{onClick:u[9]||(u[9]=s=>f.save()),loading:R(p).status.wait},{default:J(()=>[...u[23]||(u[23]=[A("保 存",-1)])]),_:1},8,["loading"])]),_:1},8,["modelValue"])],64)}}},pn={class:"card-body"},fn={class:"text-muted text-uppercase mt-0"},gn={class:"d-inline-flex align-items-center"},bn={class:"d-flex"},vn={class:"d-flex align-items-center justify-content-center position-relative",style:{width:"60px",height:"60px"}},hn={class:"d-flex flex-column justify-content-center ms-2"},yn={class:"font-18 text-dark d-flex align-items-center"},wn={class:"text-dark font-16 me-2 limit-1-line"},_n={class:"text-secondary limit-2-line"},xn={class:"row"},kn={class:"col-md-6"},Vn={class:"form-group mb-3"},zn={class:"form-label"},Sn={class:"col-md-6"},jn={class:"form-group mb-3"},Cn={class:"form-label"},Un={class:"col-md-6"},On={class:"form-group mb-3"},qn={class:"form-label"},Rn={class:"col-md-6"},Kn={class:"form-group mb-3"},In={class:"form-label"},Jn={class:"col-md-6"},An={class:"form-group mb-3"},Nn={class:"form-label"},Dn={class:"col-md-6"},$n={class:"form-group mb-3"},En={class:"form-label"},Pn={class:"col-md-4"},Tn={class:"form-group mb-3"},Ln={class:"form-label"},Mn={class:"col-md-4"},Bn={class:"form-group mb-3"},Wn={class:"form-label"},Xn={class:"col-md-4"},Fn={class:"form-group mb-3"},Gn={class:"form-label"},Hn={class:"row"},Yn={class:"col-lg-12"},Qn={class:"form-group mb-3"},Zn={class:"form-label"},so={__name:"site-info",setup(e,{expose:t}){const r=z({item:{avatar:!0,keyword:""},struct:{key:"SITE_INFO",json:{title:"",avatar:"",favicon:"",copy:{code:"",link:""},police:{code:"",link:""},date:"",keyword:"",description:""},remark:"站点信息"},status:{finish:!1,loading:!0,dialog:!1},upload:{avatar:!1,favicon:!1}});S(async()=>{await m.init()});const m={init:async()=>{r.status.finish=!1,r.status.loading=!0;const{code:s,data:e}=await v.get("/api/config/one",{key:"SITE_INFO"});if(r.status.loading=!1,204===s)return m.save();200===s&&(r.struct=y.object.deep.merge(r.struct,e),e.json.keyword&&(r.item.keyword=e.json.keyword.split(",")),r.status.finish=!0)},show(){if(!r.status.finish)return h.warn("配置获取失败，无法进行配置！");r.status.dialog=!0},save:async()=>{r.status.wait=!0;const{code:s,msg:e}=await v.post("/api/config/save",{...r.struct,json:JSON.stringify(r.struct.json)});if(r.status.wait=!1,200!==s)return h.error("保存失败："+e);r.status.dialog=!1,w.del("site-info")},async upload(s="image"){const e=document.createElement("input");e.type="file",e.accept="image/*",e.addEventListener("change",async()=>{const a=new FormData;a.append("file",e.files[0]),r.upload[s]=!0;const{code:t,msg:l,data:n}=await v.post("/api/file/upload",a);if(r.upload[s]=!1,200!==t)return h.error(l);r.struct.json[s]=n.path,e.value="",h.info("上传成功！")}),e.click()}};return j(()=>r.item.keyword,s=>{r.struct.json.keyword=s?s.join(","):""}),t({init:m.init}),(e,t)=>{const p=C("i-svg"),f=s,g=C("i-lottie"),b=u,v=a,h=l,y=c,w=i,_=d,x=n,k=o;return U(),O(E,null,[q((U(),O("div",{onClick:t[1]||(t[1]=s=>m.show()),class:"card pointer mb-3"},[K("div",pn,[I(p,{name:"site",color:"rgb(var(--assist-color))",size:"50px",class:"position-absolute opacity-25",style:{right:"2rem"}}),K("h6",fn,[I(f,{content:"（点击卡片配置）站点信息，如：备案号、头像、favicon、关键词和描述等",placement:"top"},{default:J(()=>[K("span",gn,[I(p,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),t[17]||(t[17]=K("span",{class:"ms-1"},"站点信息",-1))])]),_:1})]),K("div",bn,[K("span",vn,[I(g,{name:"avatar/crane",modelValue:R(r).item.avatar,"onUpdate:modelValue":t[0]||(t[0]=s=>R(r).item.avatar=s),width:"65px",height:"65px",class:"z-index-9"},null,8,["modelValue"]),I(b,{src:R(r).struct.json.avatar,size:52,style:{top:"7px",left:"2px"},class:"avatar-shadow position-absolute"},null,8,["src"])]),K("div",hn,[K("span",yn,[K("span",wn,T(R(r).struct.json.title),1)]),K("small",_n,T(R(r).struct.json.description||"这个人很懒，什么都没留下！"),1)])])])])),[[k,R(r).status.loading]]),I(x,{modelValue:R(r).status.dialog,"onUpdate:modelValue":t[16]||(t[16]=s=>R(r).status.dialog=s),class:"custom",draggable:"","close-on-click-modal":!1},{header:J(()=>[...t[18]||(t[18]=[K("strong",{class:"flex-center"},"站 点 信 息 配 置",-1)])]),default:J(()=>[K("div",xn,[K("div",kn,[K("div",Vn,[K("label",zn,[I(f,{content:"ICP备案码",placement:"top"},{default:J(()=>[K("span",null,[I(p,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),t[19]||(t[19]=K("span",{class:"ms-1"},"ICP 备案码：",-1))])]),_:1})]),I(v,{modelValue:R(r).struct.json.copy.code,"onUpdate:modelValue":t[2]||(t[2]=s=>R(r).struct.json.copy.code=s),placeholder:"ICP备案码"},null,8,["modelValue"])])]),K("div",Sn,[K("div",jn,[K("label",Cn,[I(f,{content:"工信部网址，如：https://beian.miit.gov.cn",placement:"top"},{default:J(()=>[K("span",null,[I(p,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),t[20]||(t[20]=K("span",{class:"ms-1"},"ICP 备案链接：",-1))])]),_:1})]),I(v,{modelValue:R(r).struct.json.copy.link,"onUpdate:modelValue":t[3]||(t[3]=s=>R(r).struct.json.copy.link=s),placeholder:"如：https://beian.miit.gov.cn"},null,8,["modelValue"])])]),K("div",Un,[K("div",On,[K("label",qn,[I(f,{content:"公安备案码",placement:"top"},{default:J(()=>[K("span",null,[I(p,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),t[21]||(t[21]=K("span",{class:"ms-1"},"公安备案码：",-1))])]),_:1})]),I(v,{modelValue:R(r).struct.json.police.code,"onUpdate:modelValue":t[4]||(t[4]=s=>R(r).struct.json.police.code=s),placeholder:"公安备案码"},null,8,["modelValue"])])]),K("div",Rn,[K("div",Kn,[K("label",In,[I(f,{content:"公安备案网址，如：https://www.beian.gov.cn",placement:"top"},{default:J(()=>[K("span",null,[I(p,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),t[22]||(t[22]=K("span",{class:"ms-1"},"公安备案链接：",-1))])]),_:1})]),I(v,{modelValue:R(r).struct.json.police.link,"onUpdate:modelValue":t[5]||(t[5]=s=>R(r).struct.json.police.link=s),placeholder:"如：https://www.beian.gov.cn"},null,8,["modelValue"])])]),K("div",Jn,[K("div",An,[K("label",Nn,[I(f,{content:"本站点的头像",placement:"top"},{default:J(()=>[K("span",null,[I(p,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),t[23]||(t[23]=K("span",{class:"ms-1"},"站点头像：",-1))])]),_:1})]),I(v,{modelValue:R(r).struct.json.avatar,"onUpdate:modelValue":t[7]||(t[7]=s=>R(r).struct.json.avatar=s),class:"custom",placeholder:"填写图片地址或点击上传"},{suffix:J(()=>[I(h,{onClick:t[6]||(t[6]=s=>m.upload("avatar")),loading:R(r).upload.avatar},{default:J(()=>[R(r).upload.avatar?$("",!0):(U(),D(p,{key:0,name:"upload",color:"rgb(var(--icon-color))",size:"14px"})),t[24]||(t[24]=K("span",{class:"ms-1"},"上传",-1))]),_:1},8,["loading"])]),_:1},8,["modelValue"])])]),K("div",Dn,[K("div",$n,[K("label",En,[I(f,{content:"本站点的小图标",placement:"top"},{default:J(()=>[K("span",null,[I(p,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),t[25]||(t[25]=K("span",{class:"ms-1"},"favicon：",-1))])]),_:1})]),I(v,{modelValue:R(r).struct.json.favicon,"onUpdate:modelValue":t[9]||(t[9]=s=>R(r).struct.json.favicon=s),class:"custom",placeholder:"填写图片地址或点击上传"},{suffix:J(()=>[I(h,{onClick:t[8]||(t[8]=s=>m.upload("favicon")),loading:R(r).upload.favicon},{default:J(()=>[R(r).upload.favicon?$("",!0):(U(),D(p,{key:0,name:"upload",color:"rgb(var(--icon-color))",size:"14px"})),t[26]||(t[26]=K("span",{class:"ms-1"},"上传",-1))]),_:1},8,["loading"])]),_:1},8,["modelValue"])])]),K("div",Pn,[K("div",Tn,[K("label",Ln,[I(f,{content:"站点标题，如：米哈游",placement:"top"},{default:J(()=>[K("span",null,[I(p,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),t[27]||(t[27]=K("span",{class:"ms-1"},"站点标题：",-1))])]),_:1})]),I(v,{modelValue:R(r).struct.json.title,"onUpdate:modelValue":t[10]||(t[10]=s=>R(r).struct.json.title=s)},null,8,["modelValue"])])]),K("div",Mn,[K("div",Bn,[K("label",Wn,[I(f,{content:"网站关键词，主要用于SEO场景，有助于收录",placement:"top"},{default:J(()=>[K("span",null,[I(p,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),t[28]||(t[28]=K("span",{class:"ms-1"},"关键词：",-1))])]),_:1})]),I(w,{modelValue:R(r).item.keyword,"onUpdate:modelValue":t[11]||(t[11]=s=>R(r).item.keyword=s),"reserve-keyword":!1,"default-first-option":"","collapse-tags-tooltip":"","allow-create":"",multiple:"",filterable:"","collapse-tags":"",class:"d-block custom font-13",placeholder:"请输入站点关键词"},{default:J(()=>[(U(!0),O(E,null,P(R(r).item.keyword,(s,e)=>(U(),D(y,{key:e,label:s,value:s},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),K("div",Xn,[K("div",Fn,[K("label",Gn,[I(f,{content:"本网站运营的开始时间",placement:"top"},{default:J(()=>[K("span",null,[I(p,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),t[29]||(t[29]=K("span",{class:"ms-1"},"运营时间：",-1))])]),_:1})]),I(_,{modelValue:R(r).struct.json.date,"onUpdate:modelValue":t[12]||(t[12]=s=>R(r).struct.json.date=s),type:"date",format:"YYYY-MM-DD","value-format":"X",class:"d-block w-100 custom",placeholder:"请选择本站开设的时间"},null,8,["modelValue"])])])]),K("div",Hn,[K("div",Yn,[K("div",Qn,[K("label",Zn,[I(f,{content:"网站描述，主要用于SEO场景，有助于收录",placement:"top"},{default:J(()=>[K("span",null,[I(p,{color:"rgb(var(--icon-color))",name:"hint",size:"14px"}),t[30]||(t[30]=K("span",{class:"ms-1"},"站点描述：",-1))])]),_:1})]),I(v,{modelValue:R(r).struct.json.description,"onUpdate:modelValue":t[13]||(t[13]=s=>R(r).struct.json.description=s),autosize:{minRows:1,maxRows:10},placeholder:"站点描述！",type:"textarea"},null,8,["modelValue"])])])])]),footer:J(()=>[I(h,{onClick:t[14]||(t[14]=s=>R(r).status.dialog=!1)},{default:J(()=>[...t[31]||(t[31]=[A("取 消",-1)])]),_:1}),I(h,{onClick:t[15]||(t[15]=s=>m.save()),loading:R(r).status.wait},{default:J(()=>[...t[32]||(t[32]=[A("保 存",-1)])]),_:1},8,["loading"])]),_:1},8,["modelValue"])],64)}}},eo={class:"card"},ao={class:"card-body"},to={class:"text-muted text-uppercase mt-0"},lo={key:0},no={class:"d-inline-flex align-items-center"},oo={class:"m-b-20"},co={class:"text-muted"},io={class:"container-xxl"},ro={class:"row mb-3 mt-3"},uo={class:"col-9"},mo={class:"row mb-3"},po={class:"col-9 d-flex"},fo={class:"modal-footer d-flex justify-content-center"},go={__name:"bind",setup(t,{expose:c}){const i=z({struct:{account:null,password:null},status:{bind:!1,finish:!1,dialog:!1,loading:!0}}),u={init:async()=>{i.status.finish=!1,i.status.loading=!0;const{code:s,data:e}=await v.get("/inis/device/user");i.status.loading=!1,200===s&&(i.struct=e,i.status.bind=!0,i.status.finish=!0)},change:async s=>{if(s)return i.status.bind=s;const{code:e,msg:a}=await v.del("/inis/device/bind");return 200!==e?(i.status.bind=!0,h.error(a)):void 0},show(){i.status.dialog=!0},save:async()=>{if(y.is.empty(i.struct.account))return h.warn("请输入账号！");if(y.is.empty(i.struct.password))return h.warn("请输入密码！");i.status.wait=!0;const{code:s,msg:e}=await v.post("/inis/device/bind",i.struct);if(i.status.wait=!1,200!==s)return h.error(e);i.status.bind=!0,i.status.dialog=!1}};return S(async()=>{await u.init()}),c({init:u.init}),(t,c)=>{const d=r,p=s,f=e,g=m,b=a,v=l,h=n,y=o;return U(),O(E,null,[q((U(),O("div",eo,[K("div",ao,[I(d,{src:"https://inis.cn/favicon.ico",class:"position-absolute opacity-25",style:{right:"1.5rem",height:"55px"}}),K("h6",to,[I(p,{placement:"top"},{content:J(()=>[c[8]||(c[8]=A(" ● 程序后端部分功能依赖于官网，如检测更新、主题授权检测等",-1)),c[9]||(c[9]=K("br",null,null,-1)),c[10]||(c[10]=A(" ● 绑定仅限于为您提供更好的服务体验，不读取您的程序任何敏感信息，请放心使用",-1)),c[11]||(c[11]=K("br",null,null,-1)),R(i).status.bind?(U(),O("span",lo,"● 当前绑定账号："+T(R(i).struct.account),1)):$("",!0)]),default:J(()=>[K("span",no,[I(_,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),c[12]||(c[12]=K("span",{class:"ms-1"},"绑定官网账号",-1))])]),_:1})]),K("h2",oo,[I(f,{modelValue:R(i).status.bind,"onUpdate:modelValue":c[0]||(c[0]=s=>R(i).status.bind=s),onChange:u.change,disabled:!R(i).status.bind,"active-text":"绑定","inactive-text":"解绑"},null,8,["modelValue","onChange","disabled"])]),c[14]||(c[14]=K("span",{class:"badge bg-success font-white"}," 更多 ",-1)),K("span",co,[c[13]||(c[13]=A(" 其它配置信息，",-1)),K("span",{onClick:c[1]||(c[1]=s=>u.show()),class:"text-dark pointer"},"点我配置")])])])),[[y,R(i).status.loading]]),I(h,{modelValue:R(i).status.dialog,"onUpdate:modelValue":c[7]||(c[7]=s=>R(i).status.dialog=s),class:"custom sm","close-on-click-modal":!1},{default:J(()=>[K("div",io,[I(p,{placement:"top"},{content:J(()=>[...c[15]||(c[15]=[A(" 程序后端部分功能依赖于官网，如检测更新、主题授权检测等，绑定仅限于为您提供更好的服务体验，不读取您的任何敏感信息，请放心使用。",-1),K("br",null,null,-1)])]),default:J(()=>[I(g,{type:"success",closable:!1,center:"",class:"mb-3 box-shadow-light d-inline-flex align-items-center pointer"},{title:J(()=>[I(_,{name:"!",size:"15px",color:"var(--el-color-success)"}),c[16]||(c[16]=K("span",{class:"ms-1"},"绑定官网账号",-1))]),_:1})]),_:1}),K("div",ro,[c[17]||(c[17]=K("label",{class:"col-3 col-form-label"},"帐号：",-1)),K("div",uo,[I(b,{modelValue:R(i).struct.account,"onUpdate:modelValue":c[2]||(c[2]=s=>R(i).struct.account=s),class:"custom",placeholder:"帐号 | 邮箱 | 手机号"},null,8,["modelValue"])])]),K("div",mo,[c[18]||(c[18]=K("label",{class:"col-3 col-form-label"},"密码：",-1)),K("div",po,[I(b,{modelValue:R(i).struct.password,"onUpdate:modelValue":c[3]||(c[3]=s=>R(i).struct.password=s),onKeyup:c[4]||(c[4]=N(s=>u.save(),["enter"])),"show-password":"",class:"custom",placeholder:"请输入密码"},null,8,["modelValue"])])]),c[19]||(c[19]=K("div",{class:"flex-center"},[K("a",{href:"https://inis.zhuxu.asia",target:"_blank",class:"text-dark"},"没有账号？去注册")],-1))])]),footer:J(()=>[K("div",fo,[I(v,{onClick:c[5]||(c[5]=s=>R(i).status.dialog=!1)},{default:J(()=>[...c[20]||(c[20]=[A("取 消",-1)])]),_:1}),I(v,{onClick:c[6]||(c[6]=s=>u.save()),loading:R(i).status.wait},{default:J(()=>[A(T(R(i).status.wait?"绑定中 ...":"绑 定"),1)]),_:1},8,["loading"])])]),_:1},8,["modelValue"])],64)}}},bo={class:"card mb-3"},vo={class:"card-body"},ho={class:"text-muted text-uppercase mt-0"},yo={class:"d-inline-flex align-items-center"},wo={class:"m-b-20"},_o={class:"d-flex justify-content-between"},xo={key:0,class:"container-xxl"},ko={class:"d-flex justify-content-between align-items-center px-2 mb-2"},Vo={class:"d-flex align-items-center pointer"},zo={class:"font-13 ms-1"},So={class:"font-13"},jo={class:"el-alert el-alert--success is-light box-shadow-light d-flex justify-content-between"},Co={class:"d-flex align-items-center"},Uo={key:0,class:"mt-2 markdown"},Oo=["innerHTML"],qo={key:1,class:"container-xxl"},Ro={__name:"upgrade",setup(e,{expose:a}){const t=z({struct:{},status:{init:!0,finish:!1,dialog:!1,loading:!0,upgrade:!1},show:{upgrade:!1},version:inis.version}),c={init:async(s=!0)=>{t.status.init=s,t.status.loading=!0;const{code:e,data:a}=await v.get("/inis/theme-version/next",{theme_key:"inis",progress:"pro"});t.status.init=!1,t.status.loading=!1,200===e&&(t.struct=a)},upgrade:async()=>{var s;t.status.upgrade=!0;const{code:e,msg:a}=await v.post("/api/upgrade/theme",{id:null==(s=t.struct)?void 0:s.id});t.status.upgrade=!1,200!==e&&h.error(a),h.success("升级成功！"),await c.init(!1)},show(){t.status.dialog=!0},markdown:s=>(new Y).render(s),color:s=>{switch(s){case"design":return{color:"var(--bs-secondary)",text:"设计中"};case"dev":return{color:"var(--bs-primary)",text:"开发版"};case"test":return{color:"var(--bs-warning)",text:"测试版"};case"pro":return{color:"var(--bs-success)",text:"正式版"};case"abandon":return{color:"var(--bs-danger)",text:"停止维护"};default:return{color:"var(--bs-light)",text:"未知"}}}};return S(async()=>{await c.init()}),j(()=>t.struct,(s={})=>{t.show.upgrade=y.compare.version(s.version,t.version)}),a({init:c.init}),(e,a)=>{const i=C("i-svg"),r=s,d=l,m=u,f=p,g=n,b=o;return U(),O(E,null,[q((U(),O("div",bo,[K("div",vo,[I(i,{name:"upgrade",size:"50px",color:"rgb(var(--assist-color))",class:"position-absolute opacity-25",style:{right:"1.5rem"}}),K("h6",ho,[I(r,{placement:"top"},{content:J(()=>[...a[3]||(a[3]=[K("strong",{class:"text-success"},"inis-admin也就是当前您看到的后台界面",-1),K("br",null,null,-1),A(" ● inis-admin一般情况下是自动升级的，在超级管理员权限下检查到新版本会自动升级",-1),K("br",null,null,-1),A(" ● 自动升级检查10分钟会检查一次，也可以通过当前卡片的功能手动检查并进行升级 ",-1)])]),default:J(()=>[K("span",yo,[I(i,{name:"hint",color:"rgb(var(--icon-color))",size:"14px"}),a[4]||(a[4]=K("span",{class:"ms-1"},"inis-admin",-1))])]),_:1})]),K("h2",wo,[I(d,{onClick:a[0]||(a[0]=s=>c.init(!1)),loading:R(t).status.loading,type:"primary",size:"small",round:"",plain:"",style:{margin:"4px 0"}},{default:J(()=>[...a[5]||(a[5]=[K("span",null,"检 查 更 新",-1)])]),_:1},8,["loading"]),R(t).show.upgrade?(U(),D(d,{key:0,onClick:c.upgrade,loading:R(t).status.upgrade,type:"primary",size:"small",round:"",plain:"",class:"ms-2",style:{margin:"4px 0"}},{default:J(()=>[...a[6]||(a[6]=[K("span",null,"升 级",-1)])]),_:1},8,["onClick","loading"])):$("",!0),I(d,{onClick:c.show,type:"primary",size:"small",round:"",class:"ms-2",style:{margin:"4px 0"}},{default:J(()=>[...a[7]||(a[7]=[K("span",null,"日 志",-1)])]),_:1},8,["onClick"])]),K("div",_o,[K("span",null,"当前版本："+T(R(t).version),1),K("span",null,"最新版本："+T(R(t).struct.version||"∞"),1)])])])),[[b,R(t).status.init]]),I(g,{modelValue:R(t).status.dialog,"onUpdate:modelValue":a[2]||(a[2]=s=>R(t).status.dialog=s),class:"custom",draggable:"","close-on-click-modal":!1},{header:J(()=>[...a[8]||(a[8]=[K("strong",{class:"flex-center"},"更新日志",-1)])]),default:J(()=>{var s,e,l,n,o;return[R(y).is.empty(R(t).struct)?(U(),O("div",qo,[...a[9]||(a[9]=[K("div",{class:"el-alert el-alert--success is-light box-shadow-light flex-center"}," 无更新日志 ",-1)])])):(U(),O("div",xo,[K("div",ko,[I(r,{content:`${null==(e=null==(s=R(t).struct.result)?void 0:s.author)?void 0:e.nickname}：${null==(n=null==(l=R(t).struct.result)?void 0:l.author)?void 0:n.description}`,placement:"top"},{default:J(()=>{var s,e,a,l;return[K("div",Vo,[I(m,{src:null==(e=null==(s=R(t).struct.result)?void 0:s.author)?void 0:e.avatar,size:25,class:"avatar-shadow mirror-scan"},null,8,["src"]),K("span",zo,T(null==(l=null==(a=R(t).struct.result)?void 0:a.author)?void 0:l.nickname),1)])]}),_:1},8,["content"]),K("span",So,"时间："+T(R(y).time.to.date(null==(o=R(t).struct)?void 0:o.create_time)),1)]),K("div",jo,[K("span",null,T(R(t).struct.title),1),K("span",Co,[I(i,{name:"dot",color:c.color(R(t).struct.progress).color,size:"20px"},null,8,["color"]),A(" "+T(c.color(R(t).struct.progress).text)+"："+T(R(t).struct.version),1)])]),R(y).is.empty(R(t).struct.content)?$("",!0):(U(),O("div",Uo,[I(f,{"max-height":"400px"},{default:J(()=>[K("div",{innerHTML:c.markdown(R(t).struct.content),class:"white-space-line"},null,8,Oo)]),_:1})]))]))]}),footer:J(()=>[I(d,{onClick:a[1]||(a[1]=s=>R(t).status.dialog=!1)},{default:J(()=>[...a[10]||(a[10]=[A(" 取 消 ",-1)])]),_:1})]),_:1},8,["modelValue"])],64)}}},Ko={class:"container-fluid container-box"},Io={class:"row d-none d-lg-flex"},Jo={class:"col-lg-6 d-flex"},Ao={class:"col-lg-6 d-flex justify-content-end",style:{"z-index":"-1"}},No={class:"btn btn-auto h-35px mimic",disabled:"",type:"button"},Do={class:"row mt-3"},$o={class:"col-12"},Eo={class:"row"},Po={class:"col-md-4"},To={class:"col-md-4"},Lo={class:"col-md-4"},Mo={class:"col-md-4"},Bo={class:"col-md-4"},Wo={class:"col-md-4"},Xo={class:"row"},Fo={class:"col-md-4"},Go={class:"col-md-4"},Ho={class:"col-md-4"},Yo={class:"row"},Qo={class:"col-md-4"},Zo={class:"col-md-4"},sc={class:"col-md-4"},ec={class:"col-md-4"},ac={class:"row"},tc={class:"col-md-4"},lc={class:"col-md-4"},nc={class:"col-md-4"},oc={class:"row"},cc={class:"col-md-4"},ic={class:"col-md-4"},rc={class:"col-md-4"},uc={class:"row"},dc={class:"col-md-4"},mc={class:"col-md-4"},pc={__name:"system",setup(s){const{ctx:e,proxy:a}=M();x();const t=z({item:{title:"系统配置",tabs:"security",menu:{...k,menuList:[{label:"刷新",icon:'<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="14" height="14">\n                    <path fill="rgb(var(--menu-icon-color))" d="M608 928c-229.76 0-416-186.24-416-416h-0.128c0-0.416 0.128-0.768 0.128-1.184a95.904 95.904 0 1 0-191.872-1.184c0 0.384-0.128 0.768-0.128 1.184l0.032 0.384c0 0.288 0.096 0.544 0.096 0.8H0c0 282.784 229.216 512 512 512 282.016 0 510.592-227.968 511.872-509.632C1022.592 743.072 836.928 928 608 928z"></path>\n                    <path fill="rgb(var(--menu-icon-color))" d="M1023.872 512H1024c0-282.784-229.216-512-512-512C230.016 0 1.408 227.968 0.128 509.632 1.408 280.96 187.072 96 416 96c229.76 0 416 186.24 416 416h0.128c0 0.416-0.128 0.768-0.128 1.184a96 96 0 0 0 96 96 95.872 95.872 0 0 0 95.872-94.816c0-0.416 0.128-0.768 0.128-1.184l-0.032-0.384c0-0.288-0.096-0.544-0.096-0.8z"></path>\n                </svg>',fn:()=>l.refresh()}]}},refresh:{inis:["device-bind","upgrade"],other:["site-info","page","article"],optimize:["cache-redis","cache-file","cache-ram"],sms:["sms-email","sms-aliyun","sms-tencent"],storage:["storage-local","storage-oss","storage-cos","storage-kodo"],security:["api-key","qps","page-limit","jwt","allow-register","qps-black"]}});S(async()=>{t.item.menu.menuList.push({line:!0},...await V())});const l={refresh(...s){let e=[...t.refresh[t.item.tabs]];s=0===s.length?e:s.filter(s=>e.includes(s));for(let t of s)a.$refs[t].init()}};return document.addEventListener("contextmenu",s=>{var e;s.preventDefault(),null==(e=a.$refs.mouse)||e.show(s.x,s.y)}),(s,e)=>{const a=f,n=g;return U(),O(E,null,[K("div",Ko,[K("div",Io,[K("div",Jo,[K("button",{onClick:e[0]||(e[0]=s=>l.refresh()),class:"btn btn-auto mimic",type:"button"},"刷新")]),K("div",Ao,[K("button",No,T(R(t).item.title),1)])]),K("div",Do,[K("div",$o,[I(n,{modelValue:R(t).item.tabs,"onUpdate:modelValue":e[1]||(e[1]=s=>R(t).item.tabs=s),id:"tabs-area",class:"circle"},{default:J(()=>[I(a,{name:"security"},{label:J(()=>[...e[2]||(e[2]=[K("span",{class:"fw-bolder font-12"},"安全",-1)])]),default:J(()=>[K("div",Eo,[K("div",Po,[I(B,{ref:"api-key"},null,512)]),K("div",To,[I(W,{ref:"qps"},null,512)]),K("div",Lo,[I(F,{ref:"qps-black"},null,512)]),K("div",Mo,[I(X,{ref:"page-limit"},null,512)]),K("div",Bo,[I(ya,{ref:"jwt"},null,512)]),K("div",Wo,[I(Ze,{ref:"allow-register"},null,512)])])]),_:1}),I(a,{name:"optimize"},{label:J(()=>[...e[3]||(e[3]=[K("span",{class:"fw-bolder font-12"},"优化",-1)])]),default:J(()=>[K("div",Xo,[K("div",Fo,[I(Xa,{ref:"cache-redis",onRefresh:l.refresh},null,8,["onRefresh"])]),K("div",Go,[I(ut,{ref:"cache-file",onRefresh:l.refresh},null,8,["onRefresh"])]),K("div",Ho,[I(_t,{ref:"cache-ram",onRefresh:l.refresh},null,8,["onRefresh"])])])]),_:1}),I(a,{name:"storage"},{label:J(()=>[...e[4]||(e[4]=[K("span",{class:"fw-bolder font-12"},"存储",-1)])]),default:J(()=>[K("div",Yo,[K("div",Qo,[I(Jt,{ref:"storage-local",onRefresh:l.refresh},null,8,["onRefresh"])]),K("div",Zo,[I(rl,{ref:"storage-oss",onRefresh:l.refresh},null,8,["onRefresh"])]),K("div",sc,[I(El,{ref:"storage-cos",onRefresh:l.refresh},null,8,["onRefresh"])]),K("div",ec,[I(mn,{ref:"storage-kodo",onRefresh:l.refresh},null,8,["onRefresh"])])])]),_:1}),I(a,{name:"sms"},{label:J(()=>[...e[5]||(e[5]=[K("span",{class:"fw-bolder font-12"},"短信",-1)])]),default:J(()=>[K("div",ac,[K("div",tc,[I(Cs,{ref:"sms-email",onRefresh:l.refresh},null,8,["onRefresh"])]),K("div",lc,[I(ae,{ref:"sms-aliyun",onRefresh:l.refresh},null,8,["onRefresh"])]),K("div",nc,[I(Ae,{ref:"sms-tencent",onRefresh:l.refresh},null,8,["onRefresh"])])])]),_:1}),I(a,{name:"other"},{label:J(()=>[...e[6]||(e[6]=[K("span",{class:"fw-bolder font-12"},"配置",-1)])]),default:J(()=>[K("div",oc,[K("div",cc,[I(G,{ref:"page",onRefresh:l.refresh},null,8,["onRefresh"])]),K("div",ic,[I(H,{ref:"article",onRefresh:l.refresh},null,8,["onRefresh"])]),K("div",rc,[I(so,{ref:"site-info",onRefresh:l.refresh},null,8,["onRefresh"])])])]),_:1}),I(a,{name:"inis"},{label:J(()=>[...e[7]||(e[7]=[K("span",{class:"fw-bolder font-12"},"更新",-1)])]),default:J(()=>[K("div",uc,[K("div",dc,[I(Ro,{ref:"upgrade",onRefresh:l.refresh},null,8,["onRefresh"])]),K("div",mc,[I(go,{ref:"device-bind",onRefresh:l.refresh},null,8,["onRefresh"])])])]),_:1})]),_:1},8,["modelValue"])])])]),I(R(b),L({ref:"mouse"},R(t).item.menu),null,16)],64)}}};export{pc as default};
